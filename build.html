<!DOCTYPE html><html lang="pt-BR"><head><meta charset="UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Cubo 3D - Jogo de SequÃªncia</title><style>*{margin:0;padding:0;box-sizing:border-box} :root{--depth-sm:4px;--depth-md:8px;--depth-lg:12px;--press-depth:2px;--shadow-color:rgba(0,0,0,0.4);--shadow-dark:rgba(0,0,0,0.6);--highlight-color:rgba(255,255,255,0.3);--highlight-bright:rgba(255,255,255,0.5);--transition-fast:0.1s;--transition-normal:0.15s;--transition-slow:0.25s;--btn-size:50px;--btn-half:25px;--btn-depth:20px;--btn-press-offset:-15px;--counter-size:60px;--counter-half:30px;--counter-depth:20px;--switch-knob-size:24px;--switch-knob-half:12px;--switch-knob-depth:10px;--key-size:30px;--key-half:12px;--key-depth:8px;--key-press-offset:-6px;--crank-base-size:50px;--crank-base-half:25px;--crank-base-depth:15px;--crank-knob-size:12px;--crank-knob-half:6px;--crank-knob-depth:10px;--cyl-segments:32} body{min-height:100vh;display:flex;justify-content:center;align-items:center;background:#1a1a2e;overflow:hidden;font-family:Arial,sans-serif} .scene{width:380px;height:304px;perspective:950px} .cube{width:100%;height:100%;position:relative;transform-style:preserve-3d;transform:rotateX(-20deg) rotateY(-30deg);transition:transform 0.1s ease-out} .face{position:absolute;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:10px;padding:20px;background:#162436;border:1px solid rgba(100,106,143,0.3);backface-visibility:visible;user-select:none;left:50%;top:50%;margin-left:-200px;margin-top:-160px} .face.top{padding:0px;display:flex;align-items:center;justify-content:center} .front,.back{width:380px;height:304px;margin-left:-190px;margin-top:-152px;padding:0;gap:0;display:grid;grid-template-columns:1fr 1fr;grid-template-rows:1fr 1fr} .subface{width:100%;height:100%;display:flex;justify-content:center;align-items:center;border:1px solid rgba(255,255,255,0);background:#162436;transition:background-color 0.3s ease;transform-style:preserve-3d} .subface.solved{background-color:rgba(46,204,113,0.6)} .subface.failed{background-color:rgba(231,76,60,0.6)} .subface.solved .game-btn-3d,.subface.failed .game-btn-3d{pointer-events:none;opacity:0.6} .subface.solved .crank-3d,.subface.failed .crank-3d{pointer-events:none;opacity:0.6} .right,.left{width:76px;height:304px;margin-left:-38px;margin-top:-152px} .top,.bottom{width:380px;height:76px;margin-left:-190px;margin-top:-38px} .front{transform:translateZ(38px)} .back{transform:rotateY(180deg) translateZ(38px)} .right{transform:rotateY(90deg) translateZ(190px)} .left{transform:rotateY(-90deg) translateZ(190px)} .top{transform:rotateX(90deg) translateZ(152px)} .bottom{transform:rotateX(-90deg) translateZ(152px)} .crank-3d{width:70px;height:70px;position:relative;transform-style:preserve-3d;cursor:grab} .crank-3d:active,.crank-3d.dragging{cursor:grabbing} .crank-base{position:absolute;width:70px;height:70px;border-radius:50%;transform:translateZ(0);border:3px solid rgba(255,255,255,0.3);box-shadow:inset 0 2px 4px rgba(255,255,255,0.2),inset 0 -2px 4px rgba(0,0,0,0.3)} .crank-shaft{position:absolute;width:60px;height:60px;left:5px;top:5px;border-radius:50%;transform-style:preserve-3d;transform:translateZ(15px);background:linear-gradient( 145deg,color-mix(in srgb,var(--crank-color) 100%,white 20%) 0%,var(--crank-color) 50%,color-mix(in srgb,var(--crank-color) 100%,black 30%) 100% );border:2px solid rgba(255,255,255,0.4);box-shadow:0 4px 8px rgba(0,0,0,0.4)} .crank-3d .crank-handle{position:absolute;width:12px;height:12px;background:linear-gradient(145deg,#fff,#ccc);border-radius:50%;top:4px;left:50%;transform:translateX(-50%) translateZ(8px);box-shadow:0 2px 4px rgba(0,0,0,0.4)} .crank-3d .crank-center{position:absolute;width:20px;height:20px;left:50%;top:50%;transform:translate(-50%,-50%) translateZ(20px);background:linear-gradient(145deg,#888,#444);border-radius:50%;border:2px solid rgba(255,255,255,0.3);box-shadow:0 3px 6px rgba(0,0,0,0.5)} .crank-3d .crank-turns{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%) translateZ(10px);font-size:14px;color:white;background:rgba(0,0,0,0.7);padding:2px 8px;border-radius:4px;white-space:nowrap} .subface.solved .crank-3d,.subface.failed .crank-3d{pointer-events:none;opacity:0.6} .bomb-timer{top:10px;right:10px;padding:8px 12px;min-width:90px} .timer-display{font-size:20px;margin-bottom:3px} .timer-label{font-size:8px} .overlay{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.8);display:none;justify-content:center;align-items:center;flex-direction:column;z-index:100} .overlay.show{display:flex} .overlay.game-over{background:rgba(0,0,0,0.5);backdrop-filter:blur(10px);-webkit-backdrop-filter:blur(10px)} body.game-over .scene,body.game-over .instructions-panel,body.game-over .instructions-toggle{filter:blur(8px);transition:filter 0.5s ease} .message{font-size:24px;color:white;margin-bottom:30px;text-align:center;max-width:600px} .message.victory{color:#2ecc71} .message.failure{color:#e74c3c} .message.failure h1{font-size:48px;color:#e74c3c;margin-bottom:20px;text-shadow:0 0 20px rgba(231,76,60,0.8);font-weight:bold;letter-spacing:3px} .message.failure p{font-size:24px;color:#fff;margin-bottom:30px;text-shadow:0 0 10px rgba(255,255,255,0.5)} .message.victory h1{font-size:48px;color:#2ecc71;margin-bottom:20px;text-shadow:0 0 20px rgba(46,204,113,0.8);font-weight:bold;letter-spacing:3px} .message.victory p{font-size:24px;color:#fff;margin-bottom:30px;text-shadow:0 0 10px rgba(255,255,255,0.5)} .retry-btn{padding:12px 30px;font-size:16px;background:#3498db;color:white;border:none;border-radius:8px;cursor:pointer;transition:background 0.2s} .retry-btn:hover{background:#2980b9} .bomb-timer{position:fixed;top:20px;right:20px;background:linear-gradient(145deg,#1a1a1a,#0d0d0d);border:3px solid #e74c3c;border-radius:12px;padding:15px 20px;box-shadow:0 4px 12px rgba(0,0,0,0.4),inset 0 2px 4px rgba(255,255,255,0.1),0 0 20px rgba(231,76,60,0.3);z-index:60;font-family:"Courier New",monospace;text-align:center;min-width:160px} .led-display{display:flex;align-items:center;justify-content:center;gap:8px;background:#000;padding:10px 15px;border-radius:6px;border:2px solid #333;box-shadow:inset 0 2px 8px rgba(0,0,0,0.8)} .digit-group{display:flex;gap:4px} .led-digit{position:relative;width:24px;height:36px;margin:2px} .led-colon{color:#e74c3c;font-size:24px;font-weight:bold;text-shadow:0 0 8px rgba(231,76,60,0.8);align-self:center;margin:0 4px} .segment{position:absolute;background:#1a0000;border-radius:1px;transition:all 0.2s ease} .segment.active{background:#e74c3c;box-shadow:0 0 6px rgba(231,76,60,0.8),inset 0 1px 2px rgba(255,100,100,0.3)} .segment-a{top:0;left:2px;width:16px;height:3px;clip-path:polygon(10% 0%,90% 0%,100% 100%,0% 100%)} .segment-b{top:2px;right:0;width:3px;height:14px;clip-path:polygon(0% 10%,100% 0%,100% 90%,0% 100%)} .segment-c{bottom:2px;right:0;width:3px;height:14px;clip-path:polygon(0% 0%,100% 10%,100% 90%,0% 100%)} .segment-d{bottom:0;left:2px;width:16px;height:3px;clip-path:polygon(0% 0%,100% 0%,90% 100%,10% 100%)} .segment-e{bottom:2px;left:0;width:3px;height:14px;clip-path:polygon(0% 10%,100% 0%,100% 100%,0% 90%)} .segment-f{top:2px;left:0;width:3px;height:14px;clip-path:polygon(0% 0%,100% 10%,100% 100%,0% 90%)} .segment-g{top:50%;left:2px;width:16px;height:3px;transform:translateY(-50%);clip-path:polygon(10% 0%,90% 0%,100% 50%,90% 100%,10% 100%,0% 50%)} .timer-label{font-size:10px;color:#bdc3c7;font-weight:bold;letter-spacing:1px;text-transform:uppercase} .bomb-timer.warning{border-color:#f39c12;box-shadow:0 4px 12px rgba(0,0,0,0.4),inset 0 2px 4px rgba(255,255,255,0.1),0 0 20px rgba(243,156,18,0.4)} .bomb-timer.warning .segment.active{background:#f39c12;box-shadow:0 0 6px rgba(243,156,18,0.8),inset 0 1px 2px rgba(255,200,100,0.3)} .bomb-timer.warning .led-colon{color:#f39c12;text-shadow:0 0 8px rgba(243,156,18,0.8)} .bomb-timer.critical{border-color:#e74c3c;box-shadow:0 4px 12px rgba(0,0,0,0.4),inset 0 2px 4px rgba(255,255,255,0.1),0 0 30px rgba(231,76,60,0.6);animation:timer-pulse 1s ease-in-out infinite alternate} .bomb-timer.critical .segment.active{background:#e74c3c;box-shadow:0 0 8px rgba(231,76,60,1),inset 0 1px 2px rgba(255,100,100,0.4)} .bomb-timer.critical .led-colon{color:#e74c3c;text-shadow:0 0 12px rgba(231,76,60,1)} @keyframes timer-pulse{0%{transform:scale(1);box-shadow:0 4px 12px rgba(0,0,0,0.4),inset 0 2px 4px rgba(255,255,255,0.1),0 0 30px rgba(231,76,60,0.6)} 100%{transform:scale(1.05);box-shadow:0 6px 16px rgba(0,0,0,0.5),inset 0 2px 4px rgba(255,255,255,0.1),0 0 40px rgba(231,76,60,0.8)} } @media (min-width:768px){.scene{width:420px;height:336px;perspective:1000px} .front,.back{width:420px;height:336px;margin-left:-210px;margin-top:-168px} .right,.left{width:84px;height:336px;margin-left:-42px;margin-top:-168px} .top,.bottom{width:420px;height:84px;margin-left:-210px;margin-top:-42px} .front{transform:translateZ(42px)} .back{transform:rotateY(180deg) translateZ(42px)} .right{transform:rotateY(90deg) translateZ(210px)} .left{transform:rotateY(-90deg) translateZ(210px)} .top{transform:rotateX(90deg) translateZ(168px)} .bottom{transform:rotateX(-90deg) translateZ(168px)} .toggle-text{font-size:9px} .bomb-timer{top:15px;right:15px;padding:12px 18px;min-width:140px} .led-display{padding:8px 12px} .led-digit{width:20px;height:30px} .led-colon{font-size:20px} .timer-label{font-size:9px} .switch{width:58px;height:29px} .switch-knob{width:25px;height:25px} .switch.on .switch-knob{left:31px} .click-counter{width:68px;height:68px} } @media (min-width:1024px){.scene{width:400px;height:320px;perspective:1000px} .front,.back{width:400px;height:320px;margin-left:-200px;margin-top:-160px} .right,.left{width:80px;height:320px;margin-left:-40px;margin-top:-160px} .top,.bottom{width:400px;height:80px;margin-left:-200px;margin-top:-40px} .front{transform:translateZ(40px)} .back{transform:rotateY(180deg) translateZ(40px)} .right{transform:rotateY(90deg) translateZ(200px)} .left{transform:rotateY(-90deg) translateZ(200px)} .top{transform:rotateX(90deg) translateZ(160px)} .bottom{transform:rotateX(-90deg) translateZ(160px)} .bomb-timer{top:20px;right:20px;padding:15px 20px;min-width:160px} .led-display{padding:10px 15px} .led-digit{width:24px;height:36px} .led-colon{font-size:24px} .timer-label{font-size:10px} .message{font-size:32px} .retry-btn{padding:15px 40px;font-size:20px} .switch{width:60px;height:30px;border-radius:15px} .switch-knob{width:26px;height:26px} .switch.on .switch-knob{left:32px} .wire-cutting-container{min-height:140px;gap:15px;padding:8px} .wire-element{width:10px;min-height:100px} .safe-dial-container{width:80px;height:80px} .safe-dial-outer-ring{width:80px;height:80px} .safe-dial-inner{width:60px;height:60px} .color-sequence-container{width:100px;height:100px} .color-btn{width:45px;height:45px} } .switch{width:55px;height:28px;border-radius:14px;cursor:pointer;position:relative;transform-style:preserve-3d;background:linear-gradient( to bottom,rgba(0,0,0,0.3) 0%,rgba(0,0,0,0.1) 50%,rgba(255,255,255,0.1) 100% );box-shadow:inset 0 3px 6px rgba(0,0,0,0.4),inset 0 -1px 2px rgba(255,255,255,0.2),0 1px 2px rgba(0,0,0,0.2);transform:translateZ(var(--press-depth))} .switch-track{position:absolute;top:3px;left:3px;right:3px;bottom:3px;border-radius:12px;background:var(--switch-off-color,#95a5a6);transition:background-color 0.3s ease;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3)} .switch.on .switch-track{background:var(--switch-on-color,#2ecc71)} .switch-knob{position:absolute;width:24px;height:24px;border-radius:50%;top:2px;left:2px;transform-style:preserve-3d;transform:translateZ(var(--depth-sm));transition:transform 0.3s ease,left 0.3s ease;background:linear-gradient(145deg,#ffffff 0%,#e0e0e0 50%,#cccccc 100%);box-shadow:0 var(--depth-sm) 0 #999,0 calc(var(--depth-sm) + 2px) 6px rgba(0,0,0,0.4)} .switch.on .switch-knob{left:29px} .subface.solved .switch,.subface.failed .switch{pointer-events:none;opacity:0.6} .click-counter{width:70px;height:70px;border-radius:50%;cursor:pointer;display:flex;justify-content:center;align-items:center;border:none;position:relative;transform-style:preserve-3d;transform:translateZ(var(--depth-md));transition:transform var(--transition-normal) ease-out;background:linear-gradient( 145deg,var(--highlight-color) 0%,transparent 50%,var(--shadow-color) 100% );box-shadow:0 var(--depth-md) 0 var(--shadow-dark),0 calc(var(--depth-md) + 4px) 8px rgba(0,0,0,0.4)} .click-counter::before{content:"";position:absolute;top:50%;left:50%;width:100%;height:100%;border-radius:50%;transform:translate(-50%,-50%) translateZ(calc(var(--depth-md) * -1));background:inherit;filter:brightness(0.6)} .click-counter::after{content:"";position:absolute;top:2px;left:2px;right:2px;bottom:2px;border-radius:50%;border:2px solid var(--highlight-color);pointer-events:none} .click-counter:hover{transform:translateZ(calc(var(--depth-md) + 2px));box-shadow:0 calc(var(--depth-md) + 2px) 0 var(--shadow-dark),0 calc(var(--depth-md) + 6px) 12px rgba(0,0,0,0.5)} .click-counter:active,.click-counter.clicked{transform:translateZ(var(--press-depth));box-shadow:0 var(--press-depth) 0 var(--shadow-dark),0 calc(var(--press-depth) + 2px) 4px rgba(0,0,0,0.3);transition:transform var(--transition-fast) ease-out} .counter-display{font-size:16px;font-weight:bold;color:white;text-shadow:0 1px 2px rgba(0,0,0,0.5);position:relative;z-index:1} .subface.solved .click-counter,.subface.failed .click-counter{pointer-events:none;opacity:0.6} .keypad{display:flex;flex-direction:column;gap:4px;padding:6px;background:var(--keypad-color,#34495e);border-radius:8px;box-shadow:0 4px 8px rgba(0,0,0,0.3)} .keypad-display{width:100%;height:24px;background:#1a1a2e;border-radius:4px;color:#2ecc71;font-family:monospace;font-size:16px;display:flex;align-items:center;justify-content:center;letter-spacing:4px;border:1px solid rgba(255,255,255,0.2)} .keypad-buttons{display:grid;grid-template-columns:repeat(3,1fr);gap:3px} .keypad-btn{width:28px;height:28px;border:none;border-radius:4px;background:rgba(255,255,255,0.15);color:white;font-size:14px;font-weight:bold;cursor:pointer;transition:background 0.1s,transform 0.1s} .keypad-btn:hover{background:rgba(255,255,255,0.25)} .keypad-btn:active{transform:scale(0.95);background:rgba(255,255,255,0.35)} .keypad-clear{background:rgba(231,76,60,0.6)} .keypad-clear:hover{background:rgba(231,76,60,0.8)} .keypad-btn-placeholder{width:28px;height:28px} .subface.solved .keypad,.subface.failed .keypad{pointer-events:none;opacity:0.6} .click-counter{width:65px;height:65px} .counter-display{font-size:16px} .keypad{padding:4px;gap:2px} .keypad-display{height:20px;font-size:14px} .keypad-btn{width:22px;height:22px;font-size:12px} .keypad-3d.keypad-runes{width:220px;height:100px;padding:5px} .keypad-3d.keypad-runes .keypad-key-3d{width:18px;height:18px} .keypad-3d.keypad-runes .keypad-key-3d .btn-face{width:18px;height:18px;font-size:11px} .keypad-3d.keypad-runes .keypad-display-3d{height:24px;font-size:16px;letter-spacing:3px} .keypad-buttons-3d.keypad-runes-4col{gap:3px} .keypad-3d.keypad-runes .keypad-display-3d{height:18px;font-size:14px;letter-spacing:3px} .keypad-btn-placeholder-3d{width:16px;height:16px} .button-cylinder{position:relative;transform-style:preserve-3d;cursor:pointer;transition:transform var(--transition-normal) ease} .button-cylinder.pressed{transform:translateZ(var(--btn-press-offset))} .cylinder-top{position:absolute;width:100%;height:100%;border-radius:50%;transform:translateZ(var(--btn-half));background:radial-gradient( circle at 35% 35%,var(--cyl-color-light,#5dade2),var(--cyl-color,#3498db) 50%,var(--cyl-color-dark,#2980b9) )} .cylinder-bottom{position:absolute;width:100%;height:100%;border-radius:50%;transform:translateZ(calc(var(--btn-half) * -1));background:var(--cyl-color-darker,#1a5276)} .cylinder-body{position:absolute;width:100%;height:100%;transform-style:preserve-3d;transform:rotateX(90deg)} .cylinder-panel{position:absolute;width:6px;height:var(--btn-size);left:50%;top:50%;margin-left:-3px;margin-top:calc(var(--btn-half) * -1);background:linear-gradient( to bottom,var(--cyl-color,#3498db),var(--cyl-color-dark,#2980b9),var(--cyl-color-darker,#1a5276) )} .button-3d{position:relative;transform-style:preserve-3d;cursor:pointer;transition:transform var(--transition-normal) ease} .button-3d.pressed{transform:translateZ(var(--btn-press-offset))} .btn-face{position:absolute;width:100%;height:100%} .btn-front{transform:translateZ(var(--btn-half));background:var(--btn-color,#3498db)} .btn-back{transform:rotateY(180deg) translateZ(var(--btn-half));background:var(--btn-color-darker,#1a5276)} .btn-right{transform:rotateY(90deg) translateZ(var(--btn-half));background:var(--btn-color-dark,#2980b9)} .btn-left{transform:rotateY(-90deg) translateZ(var(--btn-half));background:var(--btn-color-dark,#2471a3)} .btn-top{transform:rotateX(90deg) translateZ(var(--btn-half));background:var(--btn-color-light,#5dade2)} .btn-bottom{transform:rotateX(-90deg) translateZ(var(--btn-half));background:var(--btn-color-darker,#1a5276)} .pressed-3d{transform:translateZ(var(--btn-press-offset)) !important;transition:transform var(--transition-fast) ease !important} .clicked-3d{transform:translateZ(var(--btn-press-offset));transition:transform var(--transition-fast) ease} .keypad-key-3d.pressed{transform:translateZ(var(--key-press-offset))} .subface.solved .button-cylinder,.subface.solved .button-3d,.subface.solved .click-counter-3d,.subface.solved .switch-3d,.subface.solved .keypad-3d,.subface.failed .button-cylinder,.subface.failed .button-3d,.subface.failed .click-counter-3d,.subface.failed .switch-3d,.subface.failed .keypad-3d{pointer-events:none;opacity:0.6} .game-btn-3d{width:var(--btn-size);height:var(--btn-size);position:relative;transform-style:preserve-3d;cursor:pointer;transition:transform var(--transition-normal) ease} .game-btn-3d.pressed{transform:translateZ(var(--btn-press-offset))} .game-btn-3d .cylinder-top{position:absolute;width:var(--btn-size);height:var(--btn-size);border-radius:50%;transform:translateZ(19px);display:flex;justify-content:center;align-items:center;font-size:20px} .game-btn-3d .cylinder-bottom{position:absolute;width:var(--btn-size);height:var(--btn-size);border-radius:50%;transform:translateZ(-19px)} .game-btn-3d .cylinder-body{position:absolute;width:var(--btn-size);height:var(--btn-size);transform-style:preserve-3d;transform:rotateX(90deg)} .game-btn-3d .cylinder-panel{position:absolute;width:6px;height:40px;left:50%;top:50%;margin-left:-3px;margin-top:-20px} .switch-3d{width:40px;height:80px;position:relative;margin-bottom:40px;transform-style:preserve-3d;cursor:pointer;background:#2c3e50;border-radius:4px;border:2px solid #34495e;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3),0 2px 6px rgba(0,0,0,0.4)} .switch-track-3d{position:absolute;width:100%;height:100%;transform-style:preserve-3d;background:linear-gradient(145deg,#34495e 0%,#2c3e50 50%,#1a252f 100%);border-radius:4px} .switch-track-3d::before{content:"";position:absolute;width:20px;height:50px;left:50%;top:15px;transform:translateX(-50%);background:linear-gradient( to bottom,rgba(0,0,0,0.4) 0%,rgba(0,0,0,0.2) 50%,rgba(0,0,0,0.4) 100% );border-radius:2px;box-shadow:inset 0 1px 2px rgba(0,0,0,0.5)} .switch-knob-3d{position:absolute;width:18px;height:25px;left:50%;top:15px;transform:translateX(-50%);transform-style:preserve-3d;transform-origin:center bottom;transition:transform 0.2s ease-out;cursor:pointer} .switch-3d .switch-knob-3d{transform:translateX(-50%) translateY(20px)} .switch-3d.on .switch-knob-3d{transform:translateX(-50%) translateY(0px)} .switch-knob-3d .btn-face{position:absolute} .switch-knob-3d .btn-front{width:18px;height:25px;transform:translateZ(3px);background:linear-gradient(to bottom,#7f8c8d 0%,#95a5a6 50%,#bdc3c7 100%);border-radius:2px;border:1px solid #34495e;box-shadow:0 1px 3px rgba(0,0,0,0.4);transition:background 0.2s ease} .switch-3d.on .switch-knob-3d .btn-front{background:linear-gradient(to bottom,#95a5a6 0%,#bdc3c7 50%,#ecf0f1 100%);border-color:#7f8c8d} .switch-knob-3d .btn-back{width:18px;height:25px;transform:rotateY(180deg) translateZ(3px);background:#555;border-radius:2px} .switch-knob-3d .btn-right{width:6px;height:25px;transform:rotateY(90deg) translateZ(15px);background:linear-gradient(to bottom,#666,#444)} .switch-knob-3d .btn-left{width:6px;height:25px;transform:rotateY(-90deg) translateZ(3px);background:linear-gradient(to bottom,#666,#444)} .switch-knob-3d .btn-top{width:18px;height:6px;transform:rotateX(90deg) translateZ(22px);background:#777;border-radius:2px} .switch-knob-3d .btn-bottom{width:18px;height:6px;transform:rotateX(-90deg) translateZ(3px);background:#333;border-radius:2px} .switch-3d .circuit-label{position:absolute;bottom:-15px;left:50%;transform:translateX(-50%) translateZ(5px);font-size:8px;color:#bdc3c7;font-weight:bold;text-align:center;pointer-events:none} .switch-3d .status-led{position:absolute;width:6px;height:6px;top:5px;right:5px;border-radius:50%;background:#7f8c8d;transform:translateZ(4px);box-shadow:0 0 2px rgba(127,140,141,0.3);transition:all 0.3s ease} .switch-3d.on .status-led{background:#bdc3c7;box-shadow:0 0 4px rgba(189,195,199,0.5)} .switch-3d::before{content:"";position:absolute;width:4px;height:4px;top:3px;left:3px;background:radial-gradient(circle,#95a5a6,#7f8c8d);border-radius:50%;transform:translateZ(4px);box-shadow:inset 0 1px 1px rgba(0,0,0,0.3)} .switch-3d::after{content:"";position:absolute;width:4px;height:4px;bottom:3px;left:3px;background:radial-gradient(circle,#95a5a6,#7f8c8d);border-radius:50%;transform:translateZ(4px);box-shadow:inset 0 1px 1px rgba(0,0,0,0.3)} .click-counter-3d{width:var(--counter-size);height:var(--counter-size);position:relative;transform-style:preserve-3d;cursor:pointer;transition:transform var(--transition-normal) ease} .click-counter-3d.pressed{transform:translateZ(var(--btn-press-offset))} .click-counter-3d .cylinder-top{position:absolute;width:var(--counter-size);height:var(--counter-size);border-radius:50%;transform:translateZ(19px);display:flex;justify-content:center;align-items:center;border:3px solid rgba(255,255,255,0.2);box-shadow:inset 0 2px 4px rgba(255,255,255,0.3),inset 0 -2px 4px rgba(0,0,0,0.3),0 0 10px rgba(0,0,0,0.4)} .click-counter-3d .cylinder-top::before{content:"";position:absolute;width:8px;height:8px;background:radial-gradient(circle,#fff,#ccc);border-radius:50%;top:8px;left:50%;transform:translateX(-50%);box-shadow:0 1px 2px rgba(0,0,0,0.4)} .click-counter-3d .cylinder-top::after{content:"";position:absolute;width:45px;height:45px;border:2px solid rgba(0,0,0,0.2);border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%)} .click-counter-3d .cylinder-bottom{position:absolute;width:var(--counter-size);height:var(--counter-size);border-radius:50%;transform:translateZ(-19px)} .click-counter-3d .cylinder-body{position:absolute;width:var(--counter-size);height:var(--counter-size);transform-style:preserve-3d;transform:rotateX(90deg)} .click-counter-3d .cylinder-panel{position:absolute;width:6px;height:40px;left:50%;top:50%;margin-left:-3px;margin-top:-20px} .click-counter-3d .counter-display{font-size:12px;font-weight:bold;color:white;text-shadow:0 1px 2px rgba(0,0,0,0.5);position:relative;z-index:1;font-family:"Courier New",monospace;letter-spacing:1px} .keypad-3d{display:flex;flex-direction:column;gap:4px;padding:6px;background:var(--keypad-color,#34495e);border-radius:8px;transform-style:preserve-3d;box-shadow:0 4px 8px rgba(0,0,0,0.3);width:180px;height:140px} .keypad-display-3d{width:100%;min-height:28px;background:#1a1a2e;border-radius:4px;color:#2ecc71;font-family:monospace;font-size:18px;display:flex;align-items:center;justify-content:center;letter-spacing:4px;border:1px solid rgba(255,255,255,0.2);box-shadow:inset 0 2px 4px rgba(0,0,0,0.4)} .keypad-buttons-3d{display:grid;grid-template-columns:repeat(4,1fr);gap:3px;transform-style:preserve-3d} .keypad-buttons-3d.keypad-runes-4col{grid-template-columns:repeat(5,1fr);gap:3px} .subface .keypad-runes .keypad-runes-4col .keypad-key{width:calc(var(--key-size) + 1px);height:var(--key-size)} .keypad-key-3d{width:var(--key-size);height:var(--key-size);position:relative;transform-style:preserve-3d;cursor:pointer;transition:transform var(--transition-fast) ease} .keypad-key-3d.pressed{transform:translateZ(var(--key-press-offset))} .keypad-key-3d .btn-face{position:absolute;width:var(--key-size);height:var(--key-size);display:flex;justify-content:center;align-items:center;font-size:12px;font-weight:bold;color:white} .keypad-key-3d .btn-front{transform:translateZ(var(--key-half));background:rgba(255,255,255,0.2);border-radius:4px} .keypad-key-3d .btn-back{transform:rotateY(180deg) translateZ(var(--key-half));background:rgba(0,0,0,0.3);border-radius:4px} .keypad-key-3d .btn-right{width:var(--key-depth);transform:rotateY(90deg) translateZ(calc(var(--key-size) - var(--key-half)));background:rgba(255,255,255,0.15)} .keypad-key-3d .btn-left{width:var(--key-depth);transform:rotateY(-90deg) translateZ(var(--key-half));background:rgba(255,255,255,0.1)} .keypad-key-3d .btn-top{height:var(--key-depth);transform:rotateX(90deg) translateZ(var(--key-half));background:rgba(255,255,255,0.25)} .keypad-key-3d .btn-bottom{height:var(--key-depth);transform:rotateX(-90deg) translateZ(calc(var(--key-size) - var(--key-half)));background:rgba(0,0,0,0.2)} .keypad-key-3d.clear .btn-front{background:rgba(231,76,60,0.6)} .keypad-key-3d.clear .btn-top{background:rgba(231,76,60,0.7)} .keypad-btn-placeholder-3d{width:var(--key-size);height:var(--key-size)} .keypad-3d.keypad-runes{background:var(--keypad-color,#4a148c);border:2px solid rgba(138,43,226,0.5);box-shadow:0 4px 8px rgba(0,0,0,0.4),0 0 15px rgba(138,43,226,0.3);width:180px;height:150px;padding:5px} .keypad-3d.keypad-runes .keypad-key-3d{width:24px;height:24px} .keypad-3d.keypad-runes .keypad-key-3d .btn-face{width:24px;height:24px;font-size:14px} .keypad-3d.keypad-runes .keypad-display-3d{background:#2a0845;color:#da70d6;font-family:serif;font-size:20px;letter-spacing:5px;border:1px solid rgba(218,112,214,0.4);box-shadow:inset 0 2px 4px rgba(0,0,0,0.6),0 0 10px rgba(218,112,214,0.2);height:32px} .keypad-3d.keypad-runes .keypad-key-3d .btn-front{background:rgba(138,43,226,0.3);border:1px solid rgba(218,112,214,0.4);font-family:serif;font-size:16px;color:#da70d6;text-shadow:0 0 5px rgba(218,112,214,0.5)} .keypad-3d.keypad-runes .keypad-key-3d .btn-top{background:rgba(138,43,226,0.4)} .keypad-3d.keypad-runes .keypad-key-3d.clear .btn-front{background:rgba(139,0,139,0.6);color:#ff69b4;font-size:14px} .keypad-3d.keypad-runes .keypad-key-3d.clear .btn-top{background:rgba(139,0,139,0.7)} .keypad-key{width:calc(var(--key-size) + 9px);height:var(--key-size);background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);border-radius:4px;color:white;font-size:14px;font-weight:bold;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all 0.1s ease;user-select:none} .keypad-key:hover{background:rgba(255,255,255,0.3);border-color:rgba(255,255,255,0.5)} .keypad-key.pressed{background:rgba(255,255,255,0.4);transform:scale(0.95)} .keypad-key.clear{background:rgba(231,76,60,0.6);border-color:rgba(231,76,60,0.8)} .keypad-key.clear:hover{background:rgba(231,76,60,0.7)} .keypad-3d.keypad-runes .keypad-key{width:24px;height:24px;background:rgba(138,43,226,0.3);border:1px solid rgba(218,112,214,0.4);font-size:21px;color:#dda0dd} .keypad-3d.keypad-runes .keypad-key:hover{background:rgba(138,43,226,0.4);border-color:rgba(218,112,214,0.6)} .keypad-3d.keypad-runes .keypad-key.clear{background:rgba(139,0,139,0.6);color:#ff69b4;border-color:rgba(139,0,139,0.8)} .keypad-3d.keypad-runes .keypad-key.clear:hover{background:rgba(139,0,139,0.7)} .crank-3d-full{width:70px;height:70px;position:relative;transform-style:preserve-3d;cursor:grab} .crank-3d-full:active,.crank-3d-full.dragging{cursor:grabbing} .crank-3d-full .crank-base-3d{position:absolute;width:50px;height:50px;left:10px;top:10px;transform-style:preserve-3d} .crank-3d-full .crank-base-top{position:absolute;width:50px;height:50px;border-radius:50%;transform:translateZ(7px)} .crank-3d-full .crank-base-bottom{position:absolute;width:50px;height:50px;border-radius:50%;transform:translateZ(-7px)} .crank-3d-full .crank-base-body{position:absolute;width:50px;height:50px;transform-style:preserve-3d;transform:rotateX(90deg)} .crank-3d-full .crank-base-panel{position:absolute;width:5px;height:15px;left:50%;top:50%;margin-left:-2.5px;margin-top:-7.5px} .crank-3d-full .crank-arm-3d{position:absolute;width:70px;height:70px;transform-style:preserve-3d;transform:translateZ(10px);transition:none} .crank-3d-full .crank-shaft-3d{position:absolute;width:12px;height:12px;left:29px;top:29px;border-radius:50%;transform:translateZ(5px)} .crank-3d-full .crank-bar-3d{position:absolute;width:30px;height:8px;left:35px;top:31px;transform-style:preserve-3d} .crank-3d-full .crank-bar-face{position:absolute} .crank-3d-full .crank-bar-front{width:30px;height:8px;transform:translateZ(4px)} .crank-3d-full .crank-bar-back{width:30px;height:8px;transform:translateZ(-4px)} .crank-3d-full .crank-bar-top{width:30px;height:8px;transform:rotateX(90deg) translateZ(-4px)} .crank-3d-full .crank-bar-bottom{width:30px;height:8px;transform:rotateX(-90deg) translateZ(-4px)} .crank-3d-full .crank-bar-right{width:8px;height:8px;transform:rotateY(90deg) translateZ(26px)} .crank-3d-full .crank-bar-left{width:8px;height:8px;transform:rotateY(-90deg) translateZ(4px)} .crank-3d-full .crank-knob-3d{position:absolute;width:14px;height:14px;left:58px;top:28px;transform-style:preserve-3d} .crank-3d-full .crank-knob-top{position:absolute;width:14px;height:14px;border-radius:50%;transform:translateZ(6px)} .crank-3d-full .crank-knob-bottom{position:absolute;width:14px;height:14px;border-radius:50%;transform:translateZ(-6px)} .crank-3d-full .crank-knob-body{position:absolute;width:14px;height:14px;transform-style:preserve-3d;transform:rotateX(90deg)} .crank-3d-full .crank-knob-panel{position:absolute;width:4px;height:12px;left:50%;top:50%;margin-left:-2px;margin-top:-6px} .crank-3d-full .crank-turns{position:absolute;bottom:-25px;left:50%;transform:translateX(-50%) translateZ(10px);font-size:12px;color:white;background:rgba(0,0,0,0.7);padding:2px 8px;border-radius:4px;white-space:nowrap} .instructions-panel{position:fixed;bottom:0;left:0;right:0;background:rgba(44,62,80,0.95);border-top:2px solid #34495e;font-family:Arial,sans-serif;z-index:50;height:90vh;overflow-y:auto} .instructions-panel.collapsed{transform:translateY(100%)} .instructions-toggle{position:fixed;bottom:20px;right:20px;width:60px;height:60px;background:#3498db;border:none;border-radius:50%;color:white;cursor:pointer;display:flex;align-items:center;justify-content:center;font-size:24px;z-index:51} .instructions-toggle:hover{background:#2980b9} .seed-display{position:fixed;top:20px;left:20px;background:rgba(44,62,80,0.9);color:#ecf0f1;padding:8px 12px;border-radius:6px;font-family:"Courier New",monospace;font-size:12px;font-weight:bold;border:1px solid rgba(52,73,94,0.8);z-index:60;user-select:text;cursor:text} .seed-display:hover{background:rgba(44,62,80,1)} .instructions-content{padding:30px} .instructions-panel h3{color:#ecf0f1;margin:0 0 20px 0;font-size:24px;text-align:center} .instruction-list{display:flex;flex-direction:column;gap:15px;max-width:800px;margin:0 auto} .instruction-item{display:flex;align-items:center;gap:15px;padding:15px;background:rgba(52,73,94,0.6);border-radius:8px;border-left:4px solid #3498db} .face-index{background:#3498db;color:white;padding:8px 12px;border-radius:6px;font-weight:bold;font-size:16px;min-width:40px;text-align:center;flex-shrink:0} .instruction-text{color:#bdc3c7;font-size:16px;line-height:1.5;flex:1} .face-label{position:absolute;top:5px;right:5px;background:#3498db;color:white;padding:2px 6px;border-radius:3px;font-size:10px;font-weight:bold;z-index:5;pointer-events:none;box-shadow:0 1px 3px rgba(0,0,0,0.4);opacity:0;visibility:hidden;transition:opacity 0.3s ease,visibility 0.3s ease} body.instructions-visible .face-label{opacity:1;visibility:visible} .click-counter-3d.clicked-animation{animation:pump-action 0.2s ease-out} @keyframes pump-action{0%{transform:translateZ(19px) scale(1)} 50%{transform:translateZ(5px) scale(0.95)} 100%{transform:translateZ(19px) scale(1)} } .click-counter-3d.pressed{transform:translateZ(5px)} .switch-submit-btn{position:absolute;bottom:10px;right:10px;width:30px;height:30px;background:linear-gradient(145deg,#3498db,#2980b9);border:none;border-radius:50%;color:white;font-size:16px;font-weight:bold;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.3);transition:all 0.2s ease;transform:translateZ(5px)} .switch-submit-btn:hover{background:linear-gradient(145deg,#5dade2,#3498db);transform:translateZ(7px) scale(1.05);box-shadow:0 3px 8px rgba(0,0,0,0.4)} .switch-submit-btn:active{transform:translateZ(2px) scale(0.95);box-shadow:0 1px 3px rgba(0,0,0,0.2)} .counter-submit-btn{position:absolute;bottom:10px;right:10px;width:30px;height:30px;background:linear-gradient(145deg,#3498db,#2980b9);border:none;border-radius:50%;color:white;font-size:16px;font-weight:bold;cursor:pointer;box-shadow:0 2px 6px rgba(0,0,0,0.3);transition:all 0.2s ease;transform:translateZ(5px)} .counter-submit-btn:hover{background:linear-gradient(145deg,#5dade2,#3498db);transform:translateZ(7px) scale(1.05);box-shadow:0 3px 8px rgba(0,0,0,0.4)} .counter-submit-btn:active{transform:translateZ(2px) scale(0.95);box-shadow:0 1px 3px rgba(0,0,0,0.2)} .switch-3d:hover,.switch-3d:active,.switch-3d:focus{opacity:1 !important;filter:none !important;transform:none !important} .switch-3d{cursor:pointer} .switch-3d *{pointer-events:none} .counter-container{display:flex;align-items:center;gap:25px;transform-style:preserve-3d;flex-direction:row-reverse} .counter-tank{width:25px;height:120px;position:relative;transform-style:preserve-3d} .tank-body{width:100%;height:100%;position:relative;background:linear-gradient(145deg,#34495e,#2c3e50);border-radius:4px;border:2px solid #1a252f;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3),0 2px 6px rgba(0,0,0,0.4);overflow:hidden} .tank-liquid{position:absolute;bottom:0;left:2px;right:2px;background:linear-gradient(to top,#3498db 0%,#5dade2 50%,#85c1e9 100%);border-radius:0 0 2px 2px;transition:height 0.4s cubic-bezier(0.25,0.46,0.45,0.94);box-shadow:0 0 10px rgba(52,152,219,0.3)} .tank-liquid.bubbling{animation:bubble-effect 0.5s ease-out} @keyframes bubble-effect{0%,100%{filter:brightness(1)} 50%{filter:brightness(1.3) saturate(1.2);box-shadow:0 0 15px rgba(52,152,219,0.6)} } .tank-glass{position:absolute;top:0;left:0;right:0;bottom:0;background:linear-gradient( 90deg,transparent 0%,rgba(255,255,255,0.1) 30%,rgba(255,255,255,0.2) 50%,rgba(255,255,255,0.1) 70%,transparent 100% );border-radius:2px;pointer-events:none} .tank-mark{position:absolute;right:-8px;width:14px;height:1px;background:#7f8c8d;transform:translateZ(2px)} .tank-mark::after{content:"";position:absolute;right:-3px;top:-1px;width:14px;height:3px;background:#7f8c8d} .tank-liquid::before{content:"";position:absolute;top:-2px;left:0;right:0;height:4px;background:rgba(255,255,255,0.3);border-radius:50%;animation:wave 2s ease-in-out infinite} @keyframes wave{0%,100%{transform:scaleX(1) scaleY(0.5);opacity:0.7} 50%{transform:scaleX(1.1) scaleY(1);opacity:1} } @media (max-width:480px){.counter-container{gap:25px} .counter-tank{width:35px;height:110px} .tank-mark{right:-12px;width:50px} .tank-mark::after{right:-2px;width:14px;height:2px} } @media (min-width:481px) and (max-width:767px){.counter-container{gap:25px} .tank-y-axis{width:14px;height:80px} .y-axis-label{font-size:7px;left:19px} .counter-tank{gap:0px;height:80px} .tank-mark{right:-5px;width:14px} } .tank-y-axis{position:relative;height:100px;width:15px;display:flex;flex-direction:column;justify-content:space-between} .y-axis-mark{position:absolute;left:0px;width:8px;height:1px;background:#7f8c8d;display:flex;align-items:center} .y-axis-mark::before{content:"";width:8px;height:1px;background:#7f8c8d} .y-axis-label{position:absolute;left:10px;top:-4px;font-size:8px;color:#bdc3c7;font-weight:bold;width:10px;text-align:left} .counter-tank{display:flex;align-items:center;gap:0px;width:40px;height:105px} @media (max-width:480px){.tank-y-axis{width:16px;height:110px} .y-axis-mark{width:10px} .y-axis-mark::before{width:10px} .y-axis-label{font-size:10px;left:14px} .counter-tank{gap:2px;height:120px} .counter-container{gap:25px} } .safe-dial-container{position:relative;width:70px;height:70px;display:flex;flex-direction:column;align-items:center;justify-content:center;transform-style:preserve-3d;margin:auto} .safe-dial-outer-ring{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:70px;height:70px;border-radius:50%;border:3px solid rgba(255,255,255,0.3);box-shadow:inset 0 2px 4px rgba(255,255,255,0.2),inset 0 -2px 4px rgba(0,0,0,0.3),0 2px 6px rgba(0,0,0,0.4)} .dial-number{position:absolute;top:50%;left:50%;font-size:12px;font-weight:bold;color:#ecf0f1;text-shadow:0 1px 2px rgba(0,0,0,0.5);transform-origin:0 0;width:12px;height:12px;display:flex;align-items:center;justify-content:center;margin-left:-6px;margin-top:-6px} .safe-dial-inner{position:absolute;width:50px;height:50px;border-radius:50%;top:50%;left:50%;transform:translate(-50%,-50%);cursor:grab;border:2px solid rgba(255,255,255,0.4);box-shadow:0 2px 4px rgba(0,0,0,0.3),inset 0 1px 2px rgba(255,255,255,0.3);transition:transform 0.1s ease-out} .safe-dial-inner:active{cursor:grabbing} .dial-pointer{position:absolute;top:2px;left:50%;width:2px;height:15px;background:#e74c3c;transform:translateX(-50%);border-radius:1px;box-shadow:0 1px 2px rgba(0,0,0,0.4)} .dial-center-knob{position:absolute;top:50%;left:50%;width:16px;height:16px;border-radius:50%;transform:translate(-50%,-50%);border:1px solid rgba(255,255,255,0.3);box-shadow:0 1px 3px rgba(0,0,0,0.4),inset 0 1px 1px rgba(255,255,255,0.3)} .combination-display{position:absolute;bottom:10px;left:10px;font-size:10px;font-weight:bold;color:#ecf0f1;background:rgba(0,0,0,0.7);padding:4px 8px;border-radius:4px;font-family:"Courier New",monospace;letter-spacing:1px;min-width:35px;text-align:center} .subface.solved .safe-dial-container,.subface.failed .safe-dial-container{pointer-events:none;opacity:0.6} .color-sequence-container{position:relative;width:90px;height:90px;margin:auto;transform-style:preserve-3d} .color-btn{position:absolute;width:45px;height:45px;border-radius:4px;cursor:pointer;transform:translateZ(5px) translate(-50%,-50%) rotate(45deg);transition:all 0.15s ease;border:2px solid rgba(0,0,0,0.3);box-shadow:0 2px 4px rgba(0,0,0,0.3),inset 0 1px 2px rgba(255,255,255,0.3);background:var(--btn-color)} .color-btn:hover{transform:translateZ(7px) translate(-50%,-50%) rotate(45deg) scale(1.05);box-shadow:0 3px 6px rgba(0,0,0,0.4),inset 0 1px 2px rgba(255,255,255,0.4)} .color-btn:active,.color-btn.clicked{transform:translateZ(2px) translate(-50%,-50%) rotate(45deg) scale(0.95);box-shadow:0 1px 2px rgba(0,0,0,0.2),inset 0 1px 2px rgba(0,0,0,0.2)} .color-btn.active{background:var(--btn-color-light) !important;box-shadow:0 0 15px var(--btn-color),0 2px 4px rgba(0,0,0,0.3),inset 0 1px 2px rgba(255,255,255,0.5);transform:translateZ(8px) translate(-50%,-50%) rotate(45deg) scale(1.1)} .subface.solved .color-sequence-container,.subface.failed .color-sequence-container{pointer-events:none;opacity:0.6} .wire-cutting-container{position:relative;width:80%;height:90%;min-height:120px;display:flex;flex-direction:row;justify-content:center;align-items:center;gap:12px;padding:5px;background:linear-gradient(145deg,#2c3e50,#34495e);border-radius:8px;border:2px solid #1a252f;box-shadow:inset 0 2px 4px rgba(0,0,0,0.3)} .wire-element{width:8px;height:100%;min-height:80px;display:flex;flex-direction:column;align-items:center;justify-content:stretch;position:relative;transform-style:preserve-3d} .wire-connector{width:12px;height:6px;background:linear-gradient(145deg,#95a5a6,#7f8c8d);border-radius:2px;border:1px solid #34495e;box-shadow:0 1px 2px rgba(0,0,0,0.4),inset 0 1px 1px rgba(255,255,255,0.3);transform:translateZ(2px);flex-shrink:0;margin:0 auto} .wire-connector.top{margin-bottom:2px} .wire-connector.bottom{margin-top:2px} .wire-body{flex:1;width:8px;display:flex;flex-direction:column;align-items:center;justify-content:stretch;position:relative;cursor:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="black" d="M9.64 7.64c.23-.5.36-1.05.36-1.64 0-2.21-1.79-4-4-4S2 3.79 2 6s1.79 4 4 4c.59 0 1.14-.13 1.64-.36L10 12l-2.36 2.36C7.14 14.13 6.59 14 6 14c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4c0-.59-.13-1.14-.36-1.64L12 14l7 7h3v-2L9.64 7.64zM6 8c-1.1 0-2-.89-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2zm0 12c-1.1 0-2-.89-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"/><path fill="black" d="m22 3-1.5 1.5L17 1l-1.5 1.5L17 4l-1.5 1.5L17 7l3.5-3.5L22 5V3z"/></svg>') 12 12,crosshair;transition:all 0.2s ease;min-height:0} .wire-continuous{width:6px;height:110%;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,0.4),inset 0 1px 2px rgba(255,255,255,0.2),inset 0 -1px 2px rgba(0,0,0,0.3);transform:translateZ(1px);transition:all 0.3s ease;position:absolute;left:3px;top:-5px} .wire-element.cut .wire-continuous{display:none} .wire-element.cut .wire-body::before,.wire-element.cut .wire-body::after{content:"";position:absolute;width:8px;height:110%;border-radius:4px;box-shadow:0 2px 4px rgba(0,0,0,0.4),inset 0 1px 2px rgba(255,255,255,0.2),inset 0 -1px 2px rgba(0,0,0,0.3);background:var(--wire-color,var(--wire-pattern,#3498db));transition:all 0.5s ease} .wire-element.cut .wire-body::before{top:-5px;left:3px;height:47%;transform:translateX(-0.5px) rotate(-1deg);transform-origin:bottom center;border-radius:4px 4px 0 0;border-bottom:2px solid #cd7f32;box-shadow:0 2px 4px rgba(0,0,0,0.4),inset 0 1px 2px rgba(255,255,255,0.2),inset 0 -1px 2px rgba(0,0,0,0.3),inset 0 -2px 0 #b8860b} .wire-element.cut .wire-body::after{left:3px;bottom:-5px;height:47%;transform:translateX(0.5px) rotate(1deg);transform-origin:top center;border-radius:0 0 4px 4px;border-top:2px solid #cd7f32;box-shadow:0 2px 4px rgba(0,0,0,0.4),inset 0 1px 2px rgba(255,255,255,0.2),inset 0 -1px 2px rgba(0,0,0,0.3),inset 0 2px 0 #b8860b} .wire-element.cut .wire-body{cursor:default} .wire-sparks{position:absolute;font-size:12px;animation:spark-flash 1s ease-out;pointer-events:none} @keyframes spark-flash{0%{opacity:1;transform:scale(1)} 50%{opacity:1;transform:scale(1.5)} 100%{opacity:0;transform:scale(0.5)} } .wire-explosion{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:24px;animation:explosion-effect 2s ease-out;pointer-events:none;z-index:10} @keyframes explosion-effect{0%{opacity:0;transform:translate(-50%,-50%) scale(0)} 20%{opacity:1;transform:translate(-50%,-50%) scale(1.2)} 80%{opacity:1;transform:translate(-50%,-50%) scale(1)} 100%{opacity:0;transform:translate(-50%,-50%) scale(0.8)} } .subface.solved .wire-cutting-container,.subface.failed .wire-cutting-container{pointer-events:none;opacity:0.6} .wire-segment{height:5px} .wire-cut-zone{width:16px;height:10px} .wire-sparks{animation:spark-flash 1.5s ease-out} @keyframes spark-flash{0%{opacity:1;transform:translate(-50%,-50%) scale(1)} 50%{opacity:1;transform:translate(-50%,-50%) scale(1.2)} 100%{opacity:0;transform:translate(-50%,-50%) scale(0.8)} } .bomb-timer-3d{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) translateZ(5px);background:linear-gradient(145deg,#1a1a1a,#0d0d0d);border:3px solid #e74c3c;border-radius:12px;padding:12px 16px;box-shadow:0 4px 12px rgba(0,0,0,0.6),inset 0 2px 4px rgba(255,255,255,0.1),0 0 20px rgba(231,76,60,0.4);font-family:"Courier New",monospace;text-align:center;min-width:140px;transform-style:preserve-3d} .bomb-timer-3d.warning{border-color:#f39c12;box-shadow:0 4px 12px rgba(0,0,0,0.6),inset 0 2px 4px rgba(255,255,255,0.1),0 0 20px rgba(243,156,18,0.4)} .bomb-timer-3d.warning .segment.active{background:#f39c12;box-shadow:0 0 6px rgba(243,156,18,0.8),inset 0 1px 2px rgba(255,200,100,0.3)} .bomb-timer-3d.warning .led-colon{color:#f39c12;text-shadow:0 0 8px rgba(243,156,18,0.8)} .bomb-timer-3d.critical{border-color:#e74c3c;box-shadow:0 4px 12px rgba(0,0,0,0.6),inset 0 2px 4px rgba(255,255,255,0.1),0 0 30px rgba(231,76,60,0.6);animation:timer-pulse-3d 1s ease-in-out infinite alternate} .bomb-timer-3d.critical .segment.active{background:#e74c3c;box-shadow:0 0 8px rgba(231,76,60,1),inset 0 1px 2px rgba(255,100,100,0.4)} .bomb-timer-3d.critical .led-colon{color:#e74c3c;text-shadow:0 0 12px rgba(231,76,60,1)} @keyframes timer-pulse-3d{0%{transform:translate(-50%,-50%) translateZ(5px) scale(1);box-shadow:0 4px 12px rgba(0,0,0,0.6),inset 0 2px 4px rgba(255,255,255,0.1),0 0 30px rgba(231,76,60,0.6)} 100%{transform:translate(-50%,-50%) translateZ(8px) scale(1.05);box-shadow:0 6px 16px rgba(0,0,0,0.8),inset 0 2px 4px rgba(255,255,255,0.1),0 0 40px rgba(231,76,60,0.8)} }</style></head><body><div class="instructions-panel collapsed"><div class="instructions-content"><h3>InstruÃ§Ãµes</h3><div class="instruction-list" id="instruction-list"></div></div></div><button class="instructions-toggle" aria-label="Toggle Instructions"><span class="toggle-icon">ðŸ“‹</span></button><div class="seed-display" id="seed-display"> Seed: <span id="seed-value">0000000000</span></div><div class="scene"><div class="cube"><div class="face front"><div class="subface" data-subface="front-1"><div class="face-label">F1</div></div><div class="subface" data-subface="front-2"><div class="face-label">F2</div></div><div class="subface" data-subface="front-3"><div class="face-label">F3</div></div><div class="subface" data-subface="front-4"><div class="face-label">F4</div></div></div><div class="face back"><div class="subface" data-subface="back-1"><div class="face-label">B1</div></div><div class="subface" data-subface="back-2"><div class="face-label">B2</div></div><div class="subface" data-subface="back-3"><div class="face-label">B3</div></div><div class="subface" data-subface="back-4"><div class="face-label">B4</div></div></div><div class="face right"></div><div class="face left"></div><div class="face top"><div class="timer-display led-display"><div class="digit-group"><div class="led-digit" id="minutes-tens"><div class="segment segment-a"></div><div class="segment segment-b"></div><div class="segment segment-c"></div><div class="segment segment-d"></div><div class="segment segment-e"></div><div class="segment segment-f"></div><div class="segment segment-g"></div></div><div class="led-digit" id="minutes-ones"><div class="segment segment-a"></div><div class="segment segment-b"></div><div class="segment segment-c"></div><div class="segment segment-d"></div><div class="segment segment-e"></div><div class="segment segment-f"></div><div class="segment segment-g"></div></div></div><div class="led-colon">:</div><div class="digit-group"><div class="led-digit" id="seconds-tens"><div class="segment segment-a"></div><div class="segment segment-b"></div><div class="segment segment-c"></div><div class="segment segment-d"></div><div class="segment segment-e"></div><div class="segment segment-f"></div><div class="segment segment-g"></div></div><div class="led-digit" id="seconds-ones"><div class="segment segment-a"></div><div class="segment segment-b"></div><div class="segment segment-c"></div><div class="segment segment-d"></div><div class="segment segment-e"></div><div class="segment segment-f"></div><div class="segment segment-g"></div></div></div></div></div><div class="face bottom"></div></div></div><div class="overlay"><div class="message"></div><button class="retry-btn">Tentar Novamente</button></div><script>function addTouchSupport(element){element.addEventListener("touchstart",(e) =>{e.stopPropagation();element.classList.add("pressed");});element.addEventListener("touchend",() =>{element.classList.remove("pressed");});element.addEventListener("touchcancel",() =>{element.classList.remove("pressed");});} function lightenColor(hex,percent){const num = parseInt(hex.replace("#",""),16);const amt = Math.round(2.55 * percent);const R = Math.min(255,(num>> 16) + amt);const G = Math.min(255,((num>> 8) & 0x00ff) + amt);const B = Math.min(255,(num & 0x0000ff) + amt);return `#${((1 <<24) + (R <<16) + (G <<8) + B).toString(16).slice(1)}`;} function darkenColor(hex,percent){const num = parseInt(hex.replace("#",""),16);const amt = Math.round(2.55 * percent);const R = Math.max(0,(num>> 16) - amt);const G = Math.max(0,((num>> 8) & 0x00ff) - amt);const B = Math.max(0,(num & 0x0000ff) - amt);return `#${((1 <<24) + (R <<16) + (G <<8) + B).toString(16).slice(1)}`;} function createCylinderPanels( container,panels = 48,radius = 20,color = "#3498db" ){for (let i = 0;i <panels;i++){const panel = document.createElement("div");panel.className = "cylinder-panel";const angle = (i / panels) * 360;panel.style.transform = `rotateY(${angle}deg) translateZ(${radius}px)`;panel.style.background = `linear-gradient(to bottom,${color},${darkenColor( color,20 )},${darkenColor(color,40)})`;container.appendChild(panel);} } const templatesCatalog = [{id: "template-single-button",devices: [{type: "button",id: "btn-red",color: "#e74c3c",label: "ðŸ”´" }],solution: ["btn-red"],},{id: "template-two-buttons",devices: [{type: "button",id: "btn-yellow",color: "#f1c40f",label: "ðŸŸ¡" },{type: "button",id: "btn-blue",color: "#3498db",label: "ðŸ”µ" },],solution: ["btn-yellow"],},{id: "template-three-buttons",devices: [{type: "button",id: "btn-green",color: "#2ecc71",label: "ðŸŸ¢" },{type: "button",id: "btn-orange",color: "#e67e22",label: "ðŸŸ " },{type: "button",id: "btn-purple",color: "#9b59b6",label: "ðŸŸ£" },],solution: ["btn-green"],},{id: "template-crank-cw",devices: [{type: "crank",id: "crank-1",color: "#9b59b6" }],solution: [{crankId: "crank-1",direction: "cw",turns: 1 }],},{id: "template-crank-ccw",devices: [{type: "crank",id: "crank-2",color: "#1abc9c" }],solution: [{crankId: "crank-2",direction: "ccw",turns: 1 }],},{id: "template-two-cranks",devices: [{type: "crank",id: "crank-a",color: "#e74c3c" },{type: "crank",id: "crank-b",color: "#3498db" },],solution: [{crankId: "crank-a",direction: "cw",turns: 1 }],},{id: "template-button-crank",devices: [{type: "button",id: "btn-cyan",color: "#00bcd4",label: "ðŸ”µ" },{type: "crank",id: "crank-3",color: "#ff5722" },],solution: ["btn-cyan",{crankId: "crank-3",direction: "cw",turns: 1 }],},{id: "template-crank-button",devices: [{type: "crank",id: "crank-4",color: "#673ab7" },{type: "button",id: "btn-lime",color: "#cddc39",label: "ðŸŸ¢" },],solution: [{crankId: "crank-4",direction: "ccw",turns: 1 },"btn-lime"],},{id: "template-button-sequence",devices: [{type: "button",id: "btn-pink",color: "#e91e63",label: "ðŸ©·" },{type: "button",id: "btn-teal",color: "#009688",label: "ðŸ©µ" },],solution: ["btn-pink","btn-teal"],},{id: "template-crank-two-turns",devices: [{type: "crank",id: "crank-5",color: "#795548" }],solution: [{crankId: "crank-5",direction: "cw",turns: 2 }],},{id: "template-mixed-three",devices: [{type: "button",id: "btn-amber",color: "#ffc107",label: "ðŸŸ¡" },{type: "crank",id: "crank-6",color: "#607d8b" },{type: "button",id: "btn-indigo",color: "#3f51b5",label: "ðŸ”µ" },],solution: ["btn-amber",{crankId: "crank-6",direction: "cw",turns: 1 }],},{id: "template-complex",devices: [{type: "button",id: "btn-deep-orange",color: "#ff5722",label: "ðŸŸ " },{type: "button",id: "btn-light-green",color: "#8bc34a",label: "ðŸŸ¢" },{type: "crank",id: "crank-7",color: "#00bcd4" },],solution: [ "btn-deep-orange",{crankId: "crank-7",direction: "ccw",turns: 1 },],},{id: "template-switch-two",devices: [{type: "switch",id: "sw-1",color: "#95a5a6",onColor: "#2ecc71" },{type: "switch",id: "sw-2",color: "#95a5a6",onColor: "#e74c3c" },],solution: ["sw-1","sw-2"],},{id: "template-switch-five",devices: [{type: "switch",id: "sw-1",color: "#95a5a6",onColor: "#2ecc71" },{type: "switch",id: "sw-2",color: "#95a5a6",onColor: "#e74c3c" },{type: "switch",id: "sw-3",color: "#95a5a6",onColor: "#3498db" },{type: "switch",id: "sw-4",color: "#95a5a6",onColor: "#f1c40f" },{type: "switch",id: "sw-5",color: "#95a5a6",onColor: "#9b59b6" },],solution: ["sw-1","sw-3","sw-5"],},{id: "template-switch-three",devices: [{type: "switch",id: "sw-a",color: "#95a5a6",onColor: "#3498db" },{type: "switch",id: "sw-b",color: "#95a5a6",onColor: "#f1c40f" },{type: "switch",id: "sw-c",color: "#95a5a6",onColor: "#9b59b6" },],solution: ["sw-b","sw-a","sw-c"],},{id: "template-switch-four",devices: [{type: "switch",id: "sw-1",color: "#95a5a6",onColor: "#e74c3c" },{type: "switch",id: "sw-2",color: "#95a5a6",onColor: "#2ecc71" },{type: "switch",id: "sw-3",color: "#95a5a6",onColor: "#3498db" },{type: "switch",id: "sw-4",color: "#95a5a6",onColor: "#f39c12" },],solution: ["sw-3","sw-1","sw-4","sw-2"],},{id: "template-counter-five",devices: [{type: "click-counter",id: "counter-1",color: "#9b59b6",target: 5 },],solution: [{counterId: "counter-1",clicks: 5 }],},{id: "template-counter-three",devices: [{type: "click-counter",id: "counter-1",color: "#e74c3c",target: 3 },],solution: [{counterId: "counter-1",clicks: 3 }],},{id: "template-counter-ten",devices: [{type: "click-counter",id: "counter-1",color: "#1abc9c",target: 10 },],solution: [{counterId: "counter-1",clicks: 10 }],},{id: "template-keypad-four",devices: [{type: "keypad",id: "keypad-1",color: "#2c3e50" }],solution: [{keypadId: "keypad-1",password: "1234" }],},{id: "template-keypad-three",devices: [{type: "keypad",id: "keypad-1",color: "#34495e" }],solution: [{keypadId: "keypad-1",password: "742" }],},{id: "template-keypad-six",devices: [{type: "keypad",id: "keypad-1",color: "#1a252f" }],solution: [{keypadId: "keypad-1",password: "159357" }],},{id: "template-keypad-runes",devices: [{type: "keypad-runes",id: "keypad-runes-1",color: "#4a148c" }],solution: [{keypadId: "keypad-runes-1",password: "áš áš¢áš¦áš¹" }],},{id: "template-safe-dial",devices: [{type: "safe-dial",id: "safe-dial-1",color: "#2c3e50",combination: [20,80,50],},],solution: [{safeDialId: "safe-dial-1",combination: [20,80,50],},],},{id: "template-color-sequence",devices: [{type: "color-sequence",id: "color-seq-1",sequence: ["red","blue","green","yellow","red"],},],solution: [{colorSequenceId: "color-seq-1",sequence: ["red","blue","green","yellow"],},],},{id: "template-wire-cutting",devices: [{type: "wire-cutting",id: "wire-cut-1",wires: [{colors: ["red","yellow"],correct: false },{colors: ["blue","white"],correct: true },{colors: ["green","black"],correct: true },{colors: ["orange","blue"],correct: false },{colors: ["white","red"],correct: false },],},],solution: [{wireCuttingId: "wire-cut-1",correctWires: ["blue-white","green-black"],requiredCuts: 2,},],},{id: "template-wire-cutting-2",devices: [{type: "wire-cutting",id: "wire-cut-2",wires: [{colors: ["yellow","green"],correct: true },{colors: ["red","blue"],correct: false },{colors: ["white","orange"],correct: true },{colors: ["black","yellow"],correct: false },{colors: ["blue","green"],correct: false },],},],solution: [{wireCuttingId: "wire-cut-2",correctWires: ["yellow-green","white-orange"],requiredCuts: 2,},],},];function getTemplateById(templateId){return templatesCatalog.find((t) => t.id === templateId);} const state ={rotateX: -20,rotateY: -30,isDragging: false,lastX: 0,lastY: 0,};const gameState ={isGameOver: false,hasWon: false,currentSeed: null,};const bombTimer ={totalSeconds: 240,isRunning: false,intervalId: null,timerElement: null,minutesElement: null,secondsElement: null,};const crankState ={activeCrank: null,activeSubface: null,startAngle: 0,currentAngle: 0,accumulatedRotation: 0,turnsCompleted: 0,currentDirection: null,crankAngles:{},};const subfaceStates ={};function initializeSubfaces(){Object.keys(gameConfig.subfaces).forEach((subfaceId) =>{const templateId = gameConfig.subfaces[subfaceId];subfaceStates[subfaceId] ={templateId: templateId,currentSequence: [],status: "pending",};});} const sensitivity = 0.5;const cube = document.querySelector(".cube");function updateRotation(deltaX,deltaY){state.rotateY += deltaX * sensitivity;state.rotateX -= deltaY * sensitivity;} function applyTransform(){cube.style.transform = `rotateX(${state.rotateX}deg) rotateY(${state.rotateY}deg)`;} function handleDragStart(x,y){state.isDragging = true;state.lastX = x;state.lastY = y;} function handleDragMove(x,y){if (!state.isDragging) return;const deltaX = x - state.lastX;const deltaY = y - state.lastY;updateRotation(deltaX,deltaY);applyTransform();state.lastX = x;state.lastY = y;} function handleDragEnd(){state.isDragging = false;} const gameConfig ={subfaces:{"front-1": "template-switch-five","front-2": "template-wire-cutting-2","front-3": "template-keypad-runes","front-4": "template-safe-dial","back-1": "template-wire-cutting","back-2": "template-counter-three","back-3": "template-keypad-three","back-4": "template-color-sequence",},};const digitSegments ={0: ["a","b","c","d","e","f"],1: ["b","c"],2: ["a","b","g","e","d"],3: ["a","b","g","c","d"],4: ["f","g","b","c"],5: ["a","f","g","c","d"],6: ["a","f","g","e","d","c"],7: ["a","b","c"],8: ["a","b","c","d","e","f","g"],9: ["a","b","c","d","f","g"],};function updateLEDDigit(digitId,number){const digit = document.getElementById(digitId);if (!digit) return;const segments = digit.querySelectorAll(".segment");segments.forEach((segment) => segment.classList.remove("active"));const activeSegments = digitSegments[number] || [];activeSegments.forEach((segmentName) =>{const segment = digit.querySelector(`.segment-${segmentName}`);if (segment){segment.classList.add("active");} });} function initializeBombTimer(){bombTimer.timerElement = document.querySelector(".led-display");updateTimerDisplay();startBombTimer();} function updateTimerDisplay(){const minutes = Math.floor(bombTimer.totalSeconds / 60);const seconds = bombTimer.totalSeconds % 60;const minutesTens = Math.floor(minutes / 10);const minutesOnes = minutes % 10;const secondsTens = Math.floor(seconds / 10);const secondsOnes = seconds % 10;updateLEDDigit("minutes-tens",minutesTens);updateLEDDigit("minutes-ones",minutesOnes);updateLEDDigit("seconds-tens",secondsTens);updateLEDDigit("seconds-ones",secondsOnes);bombTimer.timerElement.classList.remove("warning","critical");if (bombTimer.totalSeconds <= 30){bombTimer.timerElement.classList.add("critical");} else if (bombTimer.totalSeconds <= 60){bombTimer.timerElement.classList.add("warning");} } function startBombTimer(){if (bombTimer.isRunning) return;bombTimer.isRunning = true;bombTimer.intervalId = setInterval(() =>{if (bombTimer.totalSeconds> 0){bombTimer.totalSeconds--;updateTimerDisplay();if (bombTimer.totalSeconds === 0){stopBombTimer();handleTimerExpired();} } },1000);} function stopBombTimer(){if (bombTimer.intervalId){clearInterval(bombTimer.intervalId);bombTimer.intervalId = null;} bombTimer.isRunning = false;} function addTimeToBomb(seconds){bombTimer.totalSeconds += seconds;updateTimerDisplay();showTimerFeedback(`+${seconds}s`,"#2ecc71");} function removeTimeFromBomb(seconds){bombTimer.totalSeconds = Math.max(0,bombTimer.totalSeconds - seconds);updateTimerDisplay();showTimerFeedback(`-${seconds}s`,"#e74c3c");if (bombTimer.totalSeconds === 0){stopBombTimer();handleTimerExpired();} } function showTimerFeedback(text,color){const feedback = document.createElement("div");feedback.textContent = text;feedback.style.cssText = ` position: absolute;top: -30px;left: 50%;transform: translateX(-50%);color: ${color};font-weight: bold;font-size: 16px;text-shadow: 0 0 10px ${color};animation: timer-feedback 2s ease-out forwards;pointer-events: none;z-index: 70;`;if (!document.querySelector("#timer-feedback-style")){const style = document.createElement("style");style.id = "timer-feedback-style";style.textContent = ` @keyframes timer-feedback{0%{opacity: 1;transform: translateX(-50%) translateY(0);} 100%{opacity: 0;transform: translateX(-50%) translateY(-20px);} } `;document.head.appendChild(style);} bombTimer.timerElement.appendChild(feedback);setTimeout(() =>{if (feedback.parentNode){feedback.parentNode.removeChild(feedback);} },2000);} function handleTimerExpired(){gameState.isGameOver = true;document.body.classList.add("game-over");const overlay = document.querySelector(".overlay");overlay.classList.add("game-over");const message = document.querySelector(".message");message.innerHTML = ` <div style="text-align: center;"><h1 style="font-size: 48px;color: #e74c3c;margin-bottom: 20px;text-shadow: 0 0 20px rgba(231,76,60,0.8);"> GAME OVER </h1><p style="font-size: 24px;color: #fff;margin-bottom: 30px;"> ðŸ’¥ TEMPO ESGOTADO! ðŸ’¥ </p></div> `;message.className = "message failure";const retryBtn = document.querySelector(".retry-btn");retryBtn.textContent = "JOGAR NOVAMENTE";retryBtn.onclick = () =>{window.location.reload();};overlay.classList.add("show");} function generateGameSeed(){const seed = Math.floor(Math.random() * 10000000000) .toString() .padStart(10,"0");gameState.currentSeed = seed;const seedElement = document.getElementById("seed-value");if (seedElement){seedElement.textContent = seed;} return seed;} function seedHash(seed,index = 0){let hash = 0;const str = seed + index.toString();for (let i = 0;i <str.length;i++){const char = str.charCodeAt(i);hash = (hash <<5) - hash + char;hash = hash & hash;} return Math.abs(hash);} function generateSafeDialCombination(seed){const digit1 = parseInt(seed[0]);const digit2 = parseInt(seed[1]);const digit3 = parseInt(seed[2]);const val1 = ((digit1 * 13 + digit2 * 7) % 10) * 10;const val2 = ((digit2 * 17 + digit3 * 11) % 10) * 10;const val3 = ((digit3 * 19 + digit1 * 23) % 10) * 10;let combination = [val1,val2,val3];if (combination[0] === combination[1]){combination[1] = (combination[1] + 10) % 100;} if (combination[1] === combination[2]){combination[2] = (combination[2] + 20) % 100;} if (combination[0] === combination[2]){combination[2] = (combination[2] + 30) % 100;} return combination;} function generateInstructions(){const instructionList = document.getElementById("instruction-list");if (!instructionList) return;instructionList.innerHTML = "";const faceLabels ={"front-1": "F1","front-2": "F2","front-3": "F3","front-4": "F4","back-1": "B1","back-2": "B2","back-3": "B3","back-4": "B4",};Object.keys(gameConfig.subfaces).forEach((subfaceId) =>{const templateId = gameConfig.subfaces[subfaceId];const template = getTemplateById(templateId);if (!template) return;const instructionText = generateInstructionText(template);const instructionItem = document.createElement("div");instructionItem.className = "instruction-item";const faceIndex = document.createElement("span");faceIndex.className = "face-index";faceIndex.textContent = faceLabels[subfaceId] || subfaceId;const instructionTextEl = document.createElement("span");instructionTextEl.className = "instruction-text";instructionTextEl.textContent = instructionText;instructionItem.appendChild(faceIndex);instructionItem.appendChild(instructionTextEl);instructionList.appendChild(instructionItem);});} function generateInstructionText(template){const solution = template.solution;switch (template.id){case "template-switch-five": const switchesToToggle = solution.filter( (s) => typeof s === "string" && s.startsWith("sw-") );const switchNumbers = switchesToToggle .map((s) => s.split("-")[1]) .join(" e ");return `Ligue os switches ${switchNumbers}`;case "template-counter-five": return "Clique no contador atÃ© o nÃ­vel 5 no tanque";case "template-counter-three": return "Clique no contador atÃ© o nÃ­vel 3 no tanque";case "template-keypad-runes": const runesPassword = solution.find((s) => s.keypadId)?.password || "";return `Digite a sequÃªncia de sÃ­mbolos: ${runesPassword}`;case "template-keypad-three": const numPassword = solution.find((s) => s.keypadId)?.password || "";return `Digite o cÃ³digo: ${numPassword}`;case "template-safe-dial": let safeCombination = [];Object.keys(gameConfig.subfaces).forEach((subfaceId) =>{if (gameConfig.subfaces[subfaceId] === "template-safe-dial"){const subfaceState = subfaceStates[subfaceId];if (subfaceState && subfaceState.safeDials){const dialState = Object.values(subfaceState.safeDials)[0];if (dialState && dialState.targetCombination){safeCombination = dialState.targetCombination;} } } });if (safeCombination.length === 0){safeCombination = solution.find((s) => s.safeDialId)?.combination || [];} return `Gire o cofre para os nÃºmeros: ${safeCombination.join(",")}`;case "template-color-sequence": const colorSeq = solution.find((s) => s.colorSequenceId)?.sequence || [];const colorNames ={red: "Vermelho",blue: "Azul",green: "Verde",yellow: "Amarelo",};const translatedColors = colorSeq.map((c) => colorNames[c] || c);return `Clique na sequÃªncia: ${translatedColors.join(",")} (${colorSeq.length } cores)`;case "template-wire-cutting": const wireData = solution.find((s) => s.wireCuttingId);if (wireData && wireData.correctWires){const wireNames = wireData.correctWires.map((wire) =>{const colors = wire.split("-");const colorMap ={blue: "azul",white: "branco",green: "verde",black: "preto",red: "vermelho",yellow: "amarelo",orange: "laranja",};return colors.map((c) => colorMap[c] || c).join("-");});return `Corte os fios: ${wireNames.join(",")}`;} return "Corte os fios corretos";case "template-wire-cutting-2": const wireData2 = solution.find((s) => s.wireCuttingId);if (wireData2 && wireData2.correctWires){const wireNames2 = wireData2.correctWires.map((wire) =>{const colors = wire.split("-");const colorMap ={blue: "azul",white: "branco",green: "verde",black: "preto",red: "vermelho",yellow: "amarelo",orange: "laranja",};return colors.map((c) => colorMap[c] || c).join("-");});return `Corte os fios: ${wireNames2.join(",")}`;} return "Corte os fios corretos";default: return "Siga as instruÃ§Ãµes do dispositivo";} } function renderSubface(subfaceId){const subfaceEl = document.querySelector(`[data-subface="${subfaceId}"]`);if (!subfaceEl){console.error(`Subface element not found: ${subfaceId}`);return;} const templateId = gameConfig.subfaces[subfaceId];const template = getTemplateById(templateId);if (!template){console.error(`Template not found: ${templateId}`);return;} subfaceEl .querySelectorAll( ".game-btn-3d,.crank-3d,.switch,.click-counter,.keypad" ) .forEach((el) => el.remove());template.devices.forEach((device) =>{const uniqueDeviceId = `${subfaceId}-${device.id}`;if (device.type === "button"){const btn = document.createElement("div");btn.className = "game-btn-3d";btn.dataset.id = uniqueDeviceId;btn.dataset.subface = subfaceId;btn.dataset.templateDeviceId = device.id;const top = document.createElement("div");top.className = "cylinder-top";top.style.background = `radial-gradient(circle at 35% 35%,${lightenColor( device.color,30 )},${device.color} 50%,${darkenColor(device.color,20)})`;top.textContent = device.label;btn.appendChild(top);const bottom = document.createElement("div");bottom.className = "cylinder-bottom";bottom.style.background = darkenColor(device.color,40);btn.appendChild(bottom);const body = document.createElement("div");body.className = "cylinder-body";createCylinderPanels(body,48,25,device.color);btn.appendChild(body);btn.addEventListener("mousedown",(e) =>{e.stopPropagation();btn.classList.add("pressed");});btn.addEventListener("mouseup",(e) =>{btn.classList.remove("pressed");});btn.addEventListener("mouseleave",() =>{btn.classList.remove("pressed");});btn.addEventListener("touchstart",(e) =>{e.stopPropagation();btn.classList.add("pressed");});btn.addEventListener("touchend",(e) =>{btn.classList.remove("pressed");});btn.addEventListener("touchcancel",() =>{btn.classList.remove("pressed");});btn.addEventListener("click",(e) =>{e.stopPropagation();handleButtonClick(device.id,subfaceId);});addTouchSupport(btn);subfaceEl.appendChild(btn);} else if (device.type === "crank"){crankState.crankAngles[uniqueDeviceId] = 0;const color = device.color || "#3498db";const crankEl = document.createElement("div");crankEl.className = "crank-3d-full";crankEl.dataset.id = uniqueDeviceId;crankEl.dataset.subface = subfaceId;crankEl.dataset.templateDeviceId = device.id;const base = document.createElement("div");base.className = "crank-base-3d";const baseTop = document.createElement("div");baseTop.className = "crank-base-top";baseTop.style.background = `radial-gradient(circle at 35% 35%,${lightenColor( color,30 )},${color} 50%,${darkenColor(color,20)})`;base.appendChild(baseTop);const baseBottom = document.createElement("div");baseBottom.className = "crank-base-bottom";baseBottom.style.background = darkenColor(color,40);base.appendChild(baseBottom);const baseBody = document.createElement("div");baseBody.className = "crank-base-body";for (let i = 0;i <32;i++){const panel = document.createElement("div");panel.className = "crank-base-panel";const angle = (i / 32) * 360;panel.style.transform = `rotateY(${angle}deg) translateZ(25px)`;panel.style.background = `linear-gradient(to bottom,${color},${darkenColor( color,20 )},${darkenColor(color,40)})`;baseBody.appendChild(panel);} base.appendChild(baseBody);crankEl.appendChild(base);const arm = document.createElement("div");arm.className = "crank-arm-3d";const shaft = document.createElement("div");shaft.className = "crank-shaft-3d";shaft.style.background = darkenColor(color,30);arm.appendChild(shaft);const bar = document.createElement("div");bar.className = "crank-bar-3d";const barFaces = [{cls: "crank-bar-front",bg: color },{cls: "crank-bar-back",bg: darkenColor(color,40) },{cls: "crank-bar-top",bg: lightenColor(color,20) },{cls: "crank-bar-bottom",bg: darkenColor(color,40) },{cls: "crank-bar-right",bg: darkenColor(color,20) },{cls: "crank-bar-left",bg: darkenColor(color,20) },];barFaces.forEach((f) =>{const face = document.createElement("div");face.className = `crank-bar-face ${f.cls}`;face.style.background = f.bg;bar.appendChild(face);});arm.appendChild(bar);const knob = document.createElement("div");knob.className = "crank-knob-3d";const knobTop = document.createElement("div");knobTop.className = "crank-knob-top";knobTop.style.background = `radial-gradient(circle at 35% 35%,${lightenColor( color,30 )},${color} 50%,${darkenColor(color,20)})`;knob.appendChild(knobTop);const knobBottom = document.createElement("div");knobBottom.className = "crank-knob-bottom";knobBottom.style.background = darkenColor(color,40);knob.appendChild(knobBottom);const knobBody = document.createElement("div");knobBody.className = "crank-knob-body";for (let i = 0;i <24;i++){const panel = document.createElement("div");panel.className = "crank-knob-panel";const angle = (i / 24) * 360;panel.style.transform = `rotateY(${angle}deg) translateZ(7px)`;panel.style.background = `linear-gradient(to bottom,${color},${darkenColor( color,20 )},${darkenColor(color,40)})`;knobBody.appendChild(panel);} knob.appendChild(knobBody);arm.appendChild(knob);crankEl.appendChild(arm);const turns = document.createElement("div");turns.className = "crank-turns";turns.textContent = "0 voltas";crankEl.appendChild(turns);subfaceEl.appendChild(crankEl);} else if (device.type === "switch"){renderSwitch(subfaceEl,device,subfaceId);} else if (device.type === "click-counter"){renderClickCounter(subfaceEl,device,subfaceId);} else if (device.type === "keypad"){renderKeypad(subfaceEl,device,subfaceId);} else if (device.type === "keypad-runes"){renderKeypadRunes(subfaceEl,device,subfaceId);} else if (device.type === "safe-dial"){renderSafeDial(subfaceEl,device,subfaceId);} else if (device.type === "color-sequence"){renderColorSequence(subfaceEl,device,subfaceId);} else if (device.type === "wire-cutting"){renderWireCutting(subfaceEl,device,subfaceId);} });} function renderAllSubfaces(){Object.keys(gameConfig.subfaces).forEach((subfaceId) =>{renderSubface(subfaceId);});} function loadGameConfig(){initializeSubfaces();renderAllSubfaces();} function renderSwitch(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;if (!subfaceStates[subfaceId].switches){subfaceStates[subfaceId].switches ={};subfaceStates[subfaceId].toggleSequence = [];} let initialState = false;if ( subfaceId === "front-1" && (device.id === "sw-3" || device.id === "sw-4") ){initialState = true;} subfaceStates[subfaceId].switches[device.id] = initialState;const switchEl = document.createElement("div");switchEl.className = "switch-3d";switchEl.dataset.id = uniqueDeviceId;switchEl.dataset.subface = subfaceId;switchEl.dataset.templateDeviceId = device.id;switchEl.style.setProperty("--switch-off-color",device.color || "#95a5a6");switchEl.style.setProperty("--switch-on-color",device.onColor || "#2ecc71");const track = document.createElement("div");track.className = "switch-track-3d";switchEl.appendChild(track);const knob = document.createElement("div");knob.className = "switch-knob-3d";const faces = ["front","back","right","left","top","bottom"];faces.forEach((face) =>{const faceEl = document.createElement("div");faceEl.className = `btn-face btn-${face}`;knob.appendChild(faceEl);});switchEl.appendChild(knob);const statusLed = document.createElement("div");statusLed.className = "status-led";switchEl.appendChild(statusLed);const circuitLabel = document.createElement("div");circuitLabel.className = "circuit-label";circuitLabel.textContent = `C${device.id.slice(-1)}`;switchEl.appendChild(circuitLabel);if (initialState){switchEl.classList.add("on");} if (device.id === getLastSwitchId(subfaceId)){const submitBtn = document.createElement("button");submitBtn.className = "switch-submit-btn";submitBtn.textContent = "âœ“";submitBtn.addEventListener("click",(e) =>{e.stopPropagation();checkSwitchConfiguration(subfaceId);});subfaceEl.appendChild(submitBtn);} switchEl.addEventListener("click",(e) =>{e.stopPropagation();handleSwitchToggle(device.id,subfaceId);});subfaceEl.appendChild(switchEl);} function handleSwitchToggle(switchId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const currentState = subfaceState.switches[switchId];const newState = !currentState;subfaceState.switches[switchId] = newState;const uniqueDeviceId = `${subfaceId}-${switchId}`;const switchEl = document.querySelector( `.switch-3d[data-id="${uniqueDeviceId}"]` );if (switchEl){if (newState){switchEl.classList.add("on");} else{switchEl.classList.remove("on");} } } function checkSwitchConfiguration(subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const template = getTemplateById(subfaceState.templateId);if (!template) return;let isCorrect = true;if (subfaceId === "front-1"){isCorrect = subfaceState.switches["sw-1"] === true && subfaceState.switches["sw-2"] === false && subfaceState.switches["sw-3"] === true && subfaceState.switches["sw-4"] === false && subfaceState.switches["sw-5"] === true;} else if (subfaceId === "back-1"){isCorrect = subfaceState.switches["sw-a"] === false && subfaceState.switches["sw-b"] === true && subfaceState.switches["sw-c"] === true;} if (isCorrect){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} else{subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");} } function getLastSwitchId(subfaceId){const template = getTemplateById(gameConfig.subfaces[subfaceId]);if (!template || !template.devices) return null;const switches = template.devices.filter((d) => d.type === "switch");return switches.length> 0 ? switches[switches.length - 1].id : null;} function renderClickCounter(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;if (!subfaceStates[subfaceId].counters){subfaceStates[subfaceId].counters ={};} subfaceStates[subfaceId].counters[device.id] ={current: 0,target: device.target,lastClickTime: 0,};const counterEl = document.createElement("div");counterEl.className = "click-counter-3d";counterEl.dataset.id = uniqueDeviceId;counterEl.dataset.subface = subfaceId;counterEl.dataset.templateDeviceId = device.id;const color = device.color || "#3498db";const top = document.createElement("div");top.className = "cylinder-top";top.style.background = `radial-gradient(circle at 35% 35%,${lightenColor( color,30 )},${color} 50%,${darkenColor(color,20)})`;const display = document.createElement("div");display.className = "counter-display";display.textContent = "PUMP";top.appendChild(display);counterEl.appendChild(top);const bottom = document.createElement("div");bottom.className = "cylinder-bottom";bottom.style.background = darkenColor(color,40);counterEl.appendChild(bottom);const body = document.createElement("div");body.className = "cylinder-body";createCylinderPanels(body,48,30,color);counterEl.appendChild(body);let holdTimer = null;let isHolding = false;let hasEmptied = false;counterEl.addEventListener("mousedown",(e) =>{e.stopPropagation();counterEl.classList.add("pressed");isHolding = true;hasEmptied = false;holdTimer = setTimeout(() =>{if (isHolding){const subfaceState = subfaceStates[subfaceId];if ( subfaceState && subfaceState.counters && subfaceState.counters[device.id] ){subfaceState.counters[device.id].current = 0;updateTankLevel( subfaceId,device.id,0,subfaceState.counters[device.id].target );} counterEl.classList.remove("pressed");hasEmptied = true;isHolding = false;} },1000);});counterEl.addEventListener("mouseup",(e) =>{counterEl.classList.remove("pressed");if (isHolding && !hasEmptied && holdTimer){clearTimeout(holdTimer);setTimeout(() =>{handleCounterClick(device.id,subfaceId);},50);} isHolding = false;hasEmptied = false;});counterEl.addEventListener("mouseleave",() =>{counterEl.classList.remove("pressed");if (holdTimer){clearTimeout(holdTimer);} isHolding = false;hasEmptied = false;});counterEl.addEventListener("touchstart",(e) =>{e.stopPropagation();counterEl.classList.add("pressed");isHolding = true;hasEmptied = false;holdTimer = setTimeout(() =>{if (isHolding){const subfaceState = subfaceStates[subfaceId];if ( subfaceState && subfaceState.counters && subfaceState.counters[device.id] ){subfaceState.counters[device.id].current = 0;updateTankLevel( subfaceId,device.id,0,subfaceState.counters[device.id].target );} counterEl.classList.remove("pressed");hasEmptied = true;isHolding = false;} },1000);});counterEl.addEventListener("touchend",(e) =>{counterEl.classList.remove("pressed");if (isHolding && !hasEmptied && holdTimer){clearTimeout(holdTimer);setTimeout(() =>{handleCounterClick(device.id,subfaceId);},50);} isHolding = false;hasEmptied = false;});counterEl.addEventListener("touchcancel",() =>{counterEl.classList.remove("pressed");if (holdTimer){clearTimeout(holdTimer);} isHolding = false;hasEmptied = false;});const counterContainer = document.createElement("div");counterContainer.className = "counter-container";const tank = document.createElement("div");tank.className = "counter-tank";tank.dataset.id = uniqueDeviceId;const tankBody = document.createElement("div");tankBody.className = "tank-body";const tankLiquid = document.createElement("div");tankLiquid.className = "tank-liquid";tankLiquid.style.height = "0%";const tankGlass = document.createElement("div");tankGlass.className = "tank-glass";const yAxis = document.createElement("div");yAxis.className = "tank-y-axis";for (let i = 0;i <= 10;i++){const mark = document.createElement("div");mark.className = "y-axis-mark";mark.style.bottom = `${(i / 10) * 100}%`;if (i % 2 === 0){const label = document.createElement("span");label.className = "y-axis-label";label.textContent = i;mark.appendChild(label);} yAxis.appendChild(mark);} tankBody.appendChild(tankLiquid);tankBody.appendChild(tankGlass);tank.appendChild(tankBody);tank.appendChild(yAxis);counterContainer.appendChild(counterEl);addTouchSupport(counterEl);counterContainer.appendChild(tank);const submitBtn = document.createElement("button");submitBtn.className = "counter-submit-btn";submitBtn.textContent = "âœ“";submitBtn.addEventListener("click",(e) =>{e.stopPropagation();checkCounterLevel(subfaceId,device.id);});subfaceEl.appendChild(counterContainer);subfaceEl.appendChild(submitBtn);} function handleCounterClick(counterId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const counterState = subfaceState.counters[counterId];if (!counterState) return;const now = Date.now();if (counterState.lastClickTime && now - counterState.lastClickTime <200){return;} counterState.lastClickTime = now;counterState.current++;const uniqueDeviceId = `${subfaceId}-${counterId}`;const counterEl = document.querySelector( `.click-counter-3d[data-id="${uniqueDeviceId}"]` );if (counterEl){const display = counterEl.querySelector(".counter-display");if (display){display.textContent = "PUMP";counterEl.classList.add("clicked-animation");setTimeout(() =>{counterEl.classList.remove("clicked-animation");},150);updateTankLevel( subfaceId,counterId,counterState.current,counterState.target );} } } function updateTankLevel(subfaceId,counterId,current,target){const uniqueDeviceId = `${subfaceId}-${counterId}`;const tank = document.querySelector( `.counter-tank[data-id="${uniqueDeviceId}"]` );if (tank){const liquid = tank.querySelector(".tank-liquid");if (liquid){const level = Math.min(current,10);const percentage = (level / 10) * 100;liquid.style.height = `${percentage}%`;liquid.classList.add("bubbling");setTimeout(() =>{liquid.classList.remove("bubbling");},500);} } } function checkCounterLevel(subfaceId,counterId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const counterState = subfaceState.counters[counterId];if (!counterState) return;if (counterState.current === counterState.target){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} else{subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");} } function checkCounterTarget(subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const template = getTemplateById(subfaceState.templateId);if (!template) return;for (const counterId in subfaceState.counters){const counterState = subfaceState.counters[counterId];if (counterState.current> counterState.target){subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");return;} } const allCountersReached = Object.values(subfaceState.counters).every( (counter) => counter.current === counter.target );if (allCountersReached){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} } function renderKeypad(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;const template = getTemplateById(subfaceStates[subfaceId].templateId);const solutionItem = template.solution.find((s) => s.keypadId === device.id);const password = solutionItem ? solutionItem.password : "";if (!subfaceStates[subfaceId].keypads){subfaceStates[subfaceId].keypads ={};} subfaceStates[subfaceId].keypads[device.id] ={display: "",password: password,};const keypadEl = document.createElement("div");keypadEl.className = "keypad-3d";keypadEl.dataset.id = uniqueDeviceId;keypadEl.dataset.subface = subfaceId;keypadEl.dataset.templateDeviceId = device.id;keypadEl.style.setProperty("--keypad-color",device.color || "#34495e");const display = document.createElement("div");display.className = "keypad-display-3d";display.textContent = "";keypadEl.appendChild(display);const buttonsContainer = document.createElement("div");buttonsContainer.className = "keypad-buttons-3d";function createSimpleKey(label,isClear = false){const key = document.createElement("div");key.className = `keypad-key${isClear ? " clear" : ""}`;key.textContent = label;key.addEventListener("mousedown",(e) =>{e.stopPropagation();key.classList.add("pressed");});key.addEventListener("mouseup",() =>{key.classList.remove("pressed");});key.addEventListener("mouseleave",() =>{key.classList.remove("pressed");});return key;} for (let i = 1;i <= 9;i++){const key = createSimpleKey(String(i));key.addEventListener("click",(e) =>{e.stopPropagation();handleKeypadPress(device.id,String(i),subfaceId);});addTouchSupport(key);buttonsContainer.appendChild(key);} const zeroKey = createSimpleKey("0");zeroKey.addEventListener("click",(e) =>{e.stopPropagation();handleKeypadPress(device.id,"0",subfaceId);});addTouchSupport(zeroKey);buttonsContainer.appendChild(zeroKey);const clearKey = createSimpleKey("C",true);clearKey.addEventListener("click",(e) =>{e.stopPropagation();handleKeypadClear(device.id,subfaceId);});addTouchSupport(clearKey);buttonsContainer.appendChild(clearKey);const emptyCell = document.createElement("div");emptyCell.className = "keypad-btn-placeholder-3d";buttonsContainer.appendChild(emptyCell);keypadEl.appendChild(buttonsContainer);subfaceEl.appendChild(keypadEl);} function handleKeypadPress(keypadId,digit,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const keypadState = subfaceState.keypads[keypadId];if (!keypadState) return;if (keypadState.display.length>= keypadState.password.length) return;keypadState.display += digit;const uniqueDeviceId = `${subfaceId}-${keypadId}`;const keypadEl = document.querySelector( `.keypad-3d[data-id="${uniqueDeviceId}"]` );if (keypadEl){const display = keypadEl.querySelector(".keypad-display-3d");if (display){display.textContent = keypadState.display;} } checkKeypadPassword(subfaceId);} function handleKeypadClear(keypadId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const keypadState = subfaceState.keypads[keypadId];if (!keypadState) return;keypadState.display = "";const uniqueDeviceId = `${subfaceId}-${keypadId}`;const keypadEl = document.querySelector( `.keypad-3d[data-id="${uniqueDeviceId}"]` );if (keypadEl){const display = keypadEl.querySelector(".keypad-display-3d");if (display){display.textContent = "";} } } function checkKeypadPassword(subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;for (const keypadId in subfaceState.keypads){const keypadState = subfaceState.keypads[keypadId];const{display,password } = keypadState;if (display === password){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");return;} if (display.length === password.length && display !== password){subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");return;} } } function renderKeypadRunes(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;const template = getTemplateById(subfaceStates[subfaceId].templateId);const solutionItem = template.solution.find((s) => s.keypadId === device.id);const password = solutionItem ? solutionItem.password : "";if (!subfaceStates[subfaceId].keypads){subfaceStates[subfaceId].keypads ={};} subfaceStates[subfaceId].keypads[device.id] ={display: "",password: password,};const keypadEl = document.createElement("div");keypadEl.className = "keypad-3d keypad-runes";keypadEl.dataset.id = uniqueDeviceId;keypadEl.dataset.subface = subfaceId;keypadEl.dataset.templateDeviceId = device.id;keypadEl.style.setProperty("--keypad-color",device.color || "#4a148c");const display = document.createElement("div");display.className = "keypad-display-3d";display.textContent = "";keypadEl.appendChild(display);const buttonsContainer = document.createElement("div");buttonsContainer.className = "keypad-buttons-3d keypad-runes-4col";function createSimpleKey(label,isClear = false){const key = document.createElement("div");key.className = `keypad-key${isClear ? " clear" : ""}`;key.textContent = label;key.addEventListener("mousedown",(e) =>{e.stopPropagation();key.classList.add("pressed");});key.addEventListener("mouseup",() =>{key.classList.remove("pressed");});key.addEventListener("mouseleave",() =>{key.classList.remove("pressed");});return key;} const runicSymbols = [ "áš ","áš¢","áš¦","áš¹","ášº","áš¾","á›ˆ","á›Ÿ","á›ž","á›š","á›—","á›","á›‰","á›‡",];for (let i = 0;i <14;i++){const key = createSimpleKey(runicSymbols[i]);key.addEventListener("click",(e) =>{e.stopPropagation();handleKeypadRunesPress(device.id,runicSymbols[i],subfaceId);});addTouchSupport(key);buttonsContainer.appendChild(key);} const clearKey = createSimpleKey("âŒ«",true);clearKey.addEventListener("click",(e) =>{e.stopPropagation();handleKeypadRunesClear(device.id,subfaceId);});addTouchSupport(clearKey);buttonsContainer.appendChild(clearKey);keypadEl.appendChild(buttonsContainer);subfaceEl.appendChild(keypadEl);} function handleKeypadRunesPress(keypadId,symbol,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const keypadState = subfaceState.keypads[keypadId];if (!keypadState) return;if (keypadState.display.length>= keypadState.password.length) return;keypadState.display += symbol;const uniqueDeviceId = `${subfaceId}-${keypadId}`;const keypadEl = document.querySelector( `.keypad-3d[data-id="${uniqueDeviceId}"]` );if (keypadEl){const display = keypadEl.querySelector(".keypad-display-3d");if (display){display.textContent = keypadState.display;} } if (keypadState.display.length === keypadState.password.length){setTimeout(() =>{if (keypadState.display === keypadState.password){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} else{subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");} },500);} } function handleKeypadRunesClear(keypadId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const keypadState = subfaceState.keypads[keypadId];if (!keypadState) return;keypadState.display = "";const uniqueDeviceId = `${subfaceId}-${keypadId}`;const keypadEl = document.querySelector( `.keypad-3d[data-id="${uniqueDeviceId}"]` );if (keypadEl){const display = keypadEl.querySelector(".keypad-display-3d");if (display){display.textContent = "";} } } function handleButtonClick(buttonId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;subfaceState.currentSequence.push(buttonId);checkSubfaceSolution(subfaceId);} function checkSubfaceSolution(subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const template = getTemplateById(subfaceState.templateId);if (!template) return;const currentSeq = subfaceState.currentSequence;const solution = template.solution;const currentIndex = currentSeq.length - 1;const lastAction = currentSeq[currentIndex];const expectedAction = solution[currentIndex];if (!actionsMatch(lastAction,expectedAction)){subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");return;} if (currentSeq.length === solution.length){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} } function actionsMatch(action,expected){if (typeof expected === "string"){return action === expected;} if (typeof expected === "object" && expected.crankId){return ( typeof action === "object" && action.crankId === expected.crankId && action.direction === expected.direction && action.turns === expected.turns );} return false;} function setSubfaceStatus(subfaceId,status){const subfaceEl = document.querySelector(`[data-subface="${subfaceId}"]`);if (!subfaceEl) return;subfaceEl.classList.remove("solved","failed");if (status === "solved" || status === "failed"){subfaceEl.classList.add(status);if (status === "solved"){addTimeToBomb(10);checkGameWin();} else if (status === "failed"){removeTimeFromBomb(30);checkGameWin();} } } function checkGameWin(){const allSubfaces = Object.keys(gameConfig.subfaces);const allCompleted = allSubfaces.every((subfaceId) =>{const status = subfaceStates[subfaceId] && subfaceStates[subfaceId].status;return status === "solved" || status === "failed";});if (allCompleted && bombTimer.totalSeconds> 0){showVictory();} } function showVictory(){gameState.isGameOver = true;gameState.hasWon = true;stopBombTimer();document.body.classList.add("game-over");const overlay = document.querySelector(".overlay");overlay.classList.add("game-over","show");const message = document.querySelector(".message");message.innerHTML = ` <div style="text-align: center;"><h1 style="font-size: 48px;color: #2ecc71;margin-bottom: 20px;text-shadow: 0 0 20px rgba(46,204,113,0.8);"> PARABÃ‰NS! </h1><p style="font-size: 24px;color: #fff;margin-bottom: 30px;"> ðŸŽ‰ BOMBA DESARMADA COM SUCESSO! ðŸŽ‰ </p></div> `;message.className = "message victory";const retryBtn = document.querySelector(".retry-btn");retryBtn.textContent = "JOGAR NOVAMENTE";retryBtn.onclick = () =>{window.location.reload();};} function showFailure(){gameState.isGameOver = true;gameState.hasWon = false;stopBombTimer();const overlay = document.querySelector(".overlay");const message = document.querySelector(".message");message.textContent = "âŒ SequÃªncia Errada! Bomba Explodiu!";message.className = "message failure";overlay.classList.add("show");} function resetGame(){gameState.isGameOver = false;gameState.hasWon = false;document.body.classList.remove("game-over");stopBombTimer();bombTimer.totalSeconds = 240;updateTimerDisplay();startBombTimer();crankState.activeCrank = null;crankState.accumulatedRotation = 0;crankState.turnsCompleted = 0;crankState.currentDirection = null;Object.keys(crankState.crankAngles).forEach((id) =>{crankState.crankAngles[id] = 0;const crankEl = document.querySelector(`.crank-3d-full[data-id="${id}"]`) || document.querySelector(`.crank-3d[data-id="${id}"]`);if (crankEl){const arm = crankEl.querySelector(".crank-arm-3d") || crankEl.querySelector(".crank-shaft");if (arm){if (arm.classList.contains("crank-arm-3d")){arm.style.transform = "translateZ(10px) rotate(0deg)";} else{arm.style.transform = "translateZ(15px) rotate(0deg)";} } const turnsDisplay = crankEl.querySelector(".crank-turns");if (turnsDisplay) turnsDisplay.textContent = "0 voltas";} });const overlay = document.querySelector(".overlay");overlay.classList.remove("show","game-over");} function calculateAngle(centerX,centerY,x,y){const dx = x - centerX;const dy = y - centerY;return Math.atan2(dy,dx) * (180 / Math.PI);} function handleCrankDragStart(crankId,x,y,crankEl){const subfaceId = crankEl.dataset.subface;if (subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;} const rect = crankEl.getBoundingClientRect();const centerX = rect.left + rect.width / 2;const centerY = rect.top + rect.height / 2;crankState.activeCrank = crankId;crankState.activeSubface = subfaceId;crankState.startAngle = calculateAngle(centerX,centerY,x,y);crankState.currentAngle = crankState.crankAngles[crankId] || 0;crankState.accumulatedRotation = 0;crankState.turnsCompleted = 0;crankState.currentDirection = null;crankEl.classList.add("dragging");} function handleCrankDragMove(x,y){if (!crankState.activeCrank) return;const crankEl = document.querySelector( `.crank-3d-full[data-id="${crankState.activeCrank}"]` ) || document.querySelector(`.crank-3d[data-id="${crankState.activeCrank}"]`);if (!crankEl) return;const rect = crankEl.getBoundingClientRect();const centerX = rect.left + rect.width / 2;const centerY = rect.top + rect.height / 2;const newAngle = calculateAngle(centerX,centerY,x,y);let deltaAngle = newAngle - crankState.startAngle;if (deltaAngle> 180) deltaAngle -= 360;if (deltaAngle <-180) deltaAngle += 360;crankState.accumulatedRotation += deltaAngle;crankState.startAngle = newAngle;crankState.crankAngles[crankState.activeCrank] += deltaAngle;const arm = crankEl.querySelector(".crank-arm-3d") || crankEl.querySelector(".crank-shaft");if (arm){if (arm.classList.contains("crank-arm-3d")){arm.style.transform = `translateZ(10px) rotate(${crankState.crankAngles[crankState.activeCrank] }deg)`;} else{arm.style.transform = `translateZ(15px) rotate(${crankState.crankAngles[crankState.activeCrank] }deg)`;} } if (crankState.accumulatedRotation> 10 && !crankState.currentDirection){crankState.currentDirection = "cw";} else if ( crankState.accumulatedRotation <-10 && !crankState.currentDirection ){crankState.currentDirection = "ccw";} const totalTurns = Math.floor(Math.abs(crankState.accumulatedRotation) / 360);if (totalTurns> crankState.turnsCompleted){crankState.turnsCompleted = totalTurns;const turnsDisplay = crankEl.querySelector(".crank-turns");if (turnsDisplay){const dir = crankState.currentDirection === "cw" ? "â†»" : "â†º";turnsDisplay.textContent = `${crankState.turnsCompleted} volta${crankState.turnsCompleted !== 1 ? "s" : "" } ${dir}`;} registerCrankStep();} } function handleCrankDragEnd(){if (!crankState.activeCrank) return;const crankEl = document.querySelector( `.crank-3d-full[data-id="${crankState.activeCrank}"]` ) || document.querySelector(`.crank-3d[data-id="${crankState.activeCrank}"]`);if (crankEl){crankEl.classList.remove("dragging");} crankState.activeCrank = null;crankState.activeSubface = null;} function registerCrankStep(){const subfaceId = crankState.activeSubface;if (!subfaceId) return;const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const crankEl = document.querySelector( `.crank-3d-full[data-id="${crankState.activeCrank}"]` ) || document.querySelector(`.crank-3d[data-id="${crankState.activeCrank}"]`);if (!crankEl) return;const templateDeviceId = crankEl.dataset.templateDeviceId;subfaceState.currentSequence.push({crankId: templateDeviceId,direction: crankState.currentDirection,turns: crankState.turnsCompleted,});checkSubfaceSolution(subfaceId);} function isCrankElement(el){return ( el.classList.contains("crank-3d") || el.classList.contains("crank-3d-full") || el.classList.contains("crank-base") || el.classList.contains("crank-base-3d") || el.classList.contains("crank-shaft") || el.classList.contains("crank-shaft-3d") || el.classList.contains("crank-handle") || el.classList.contains("crank-center") || el.classList.contains("crank-arm-3d") || el.classList.contains("crank-bar-3d") || el.classList.contains("crank-knob-3d") || el.classList.contains("crank-bar-face") || el.classList.contains("crank-base-top") || el.classList.contains("crank-knob-top") );} function getCrankElement(el){if ( el.classList.contains("crank-3d") || el.classList.contains("crank-3d-full") ) return el;return el.closest(".crank-3d-full") || el.closest(".crank-3d");} document.querySelector(".scene").addEventListener("mousedown",(e) =>{if (e.target.closest(".game-btn-3d")) return;if (isCrankElement(e.target)){const crankEl = getCrankElement(e.target);if (crankEl){e.stopPropagation();handleCrankDragStart(crankEl.dataset.id,e.clientX,e.clientY,crankEl);return;} } handleDragStart(e.clientX,e.clientY);});document.addEventListener("mousemove",(e) =>{if (crankState.activeCrank){handleCrankDragMove(e.clientX,e.clientY);} else{handleDragMove(e.clientX,e.clientY);} });document.addEventListener("mouseup",() =>{handleCrankDragEnd();handleDragEnd();});document.querySelector(".scene").addEventListener("touchstart",(e) =>{if ( e.target.closest(".game-btn-3d") || e.target.closest(".switch-3d") || e.target.closest(".click-counter-3d") || e.target.closest(".keypad-3d") || e.target.closest(".keypad-key") || e.target.closest(".switch-submit-btn") || e.target.closest(".counter-submit-btn") || e.target.closest(".safe-dial-3d") || e.target.closest(".safe-dial-submit-btn") || e.target.closest(".color-sequence-3d") || e.target.closest(".color-button-3d") || e.target.closest(".wire-cutting-3d") || e.target.closest(".wire-body") || e.target.classList.contains("game-btn") ){return;} const touch = e.touches[0];if (isCrankElement(e.target)){const crankEl = getCrankElement(e.target);if (crankEl){e.preventDefault();e.stopPropagation();handleCrankDragStart( crankEl.dataset.id,touch.clientX,touch.clientY,crankEl );return;} } e.preventDefault();handleDragStart(touch.clientX,touch.clientY);});document.addEventListener( "touchmove",(e) =>{const touch = e.touches[0];if (crankState.activeCrank){e.preventDefault();handleCrankDragMove(touch.clientX,touch.clientY);} else if (state.isDragging){e.preventDefault();handleDragMove(touch.clientX,touch.clientY);} },{passive: false } );document.addEventListener("touchend",() =>{handleCrankDragEnd();handleDragEnd();});document.querySelector(".retry-btn")?.addEventListener("click",resetGame);document .querySelector(".instructions-toggle") ?.addEventListener("click",() =>{const panel = document.querySelector(".instructions-panel");const body = document.body;panel.classList.toggle("collapsed");if (panel.classList.contains("collapsed")){body.classList.remove("instructions-visible");} else{body.classList.add("instructions-visible");} });loadGameConfig();generateGameSeed();generateInstructions();initializeBombTimer();function renderSafeDial(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;if (!subfaceStates[subfaceId].safeDials){subfaceStates[subfaceId].safeDials ={};} let targetCombination = device.combination || [20,80,50];if (gameState.currentSeed){targetCombination = generateSafeDialCombination(gameState.currentSeed);} subfaceStates[subfaceId].safeDials[device.id] ={currentAngle: 0,enteredCombination: [],targetCombination: targetCombination,isLocked: true,};const color = device.color || "#2c3e50";const dialContainer = document.createElement("div");dialContainer.className = "safe-dial-container";dialContainer.dataset.id = uniqueDeviceId;dialContainer.dataset.subface = subfaceId;dialContainer.dataset.templateDeviceId = device.id;const outerRing = document.createElement("div");outerRing.className = "safe-dial-outer-ring";outerRing.style.background = `linear-gradient(145deg,${color},${darkenColor( color,20 )})`;for (let i = 0;i <100;i += 10){const numberMark = document.createElement("div");numberMark.className = "dial-number";numberMark.textContent = i;numberMark.style.transform = `rotate(${i * 3.6 }deg) translateY(-35px) rotate(-${i * 3.6}deg)`;numberMark.style.transformOrigin = "6px 41px";outerRing.appendChild(numberMark);} dialContainer.appendChild(outerRing);const innerDial = document.createElement("div");innerDial.className = "safe-dial-inner";innerDial.style.background = `radial-gradient(circle,${lightenColor( color,30 )},${color})`;const pointer = document.createElement("div");pointer.className = "dial-pointer";innerDial.appendChild(pointer);const centerKnob = document.createElement("div");centerKnob.className = "dial-center-knob";centerKnob.style.background = `linear-gradient(145deg,${lightenColor( color,40 )},${darkenColor(color,10)})`;innerDial.appendChild(centerKnob);dialContainer.appendChild(innerDial);const combinationDisplay = document.createElement("div");combinationDisplay.className = "combination-display";combinationDisplay.textContent = "- - -";const submitBtn = document.createElement("button");submitBtn.className = "safe-dial-submit-btn";submitBtn.textContent = "âœ“";submitBtn.addEventListener("click",(e) =>{e.stopPropagation();checkSafeDialCombination(subfaceId,device.id);});let isDragging = false;let startAngle = 0;let currentRotation = 0;function getAngleFromPointer(e,element){const rect = element.getBoundingClientRect();const centerX = rect.left + rect.width / 2;const centerY = rect.top + rect.height / 2;const pointerX = e.clientX || (e.touches && e.touches[0].clientX);const pointerY = e.clientY || (e.touches && e.touches[0].clientY);return Math.atan2(pointerY - centerY,pointerX - centerX) * (180 / Math.PI);} innerDial.addEventListener("mousedown",(e) =>{e.stopPropagation();isDragging = true;startAngle = getAngleFromPointer(e,innerDial);innerDial.style.cursor = "grabbing";});innerDial.addEventListener("touchstart",(e) =>{e.preventDefault();e.stopPropagation();isDragging = true;startAngle = getAngleFromPointer(e,innerDial);innerDial.style.cursor = "grabbing";});function handleMove(e){if (!isDragging) return;const currentAngle = getAngleFromPointer(e,innerDial);let deltaAngle = currentAngle - startAngle;if (deltaAngle> 180) deltaAngle -= 360;if (deltaAngle <-180) deltaAngle += 360;currentRotation += deltaAngle;startAngle = currentAngle;innerDial.style.transform = `translate(-50%,-50%) rotate(${currentRotation}deg)`;const dialState = subfaceStates[subfaceId].safeDials[device.id];dialState.currentAngle = ((currentRotation % 360) + 360) % 360;const currentNumber = Math.round(dialState.currentAngle / 36) * 10;updateDialDisplay(subfaceId,device.id);} function handleEnd(){if (isDragging){isDragging = false;innerDial.style.cursor = "grab";const dialState = subfaceStates[subfaceId].safeDials[device.id];const snappedNumber = Math.round(dialState.currentAngle / 36) * 10;const snappedAngle = snappedNumber * 3.6;const startRotation = currentRotation;const targetRotation = currentRotation + (snappedAngle - dialState.currentAngle);let animationStart = null;const animationDuration = 200;function animateSnap(timestamp){if (!animationStart) animationStart = timestamp;const progress = Math.min( (timestamp - animationStart) / animationDuration,1 );const easeOut = 1 - Math.pow(1 - progress,3);const currentAnimationRotation = startRotation + (targetRotation - startRotation) * easeOut;innerDial.style.transform = `translate(-50%,-50%) rotate(${currentAnimationRotation}deg)`;if (progress <1){requestAnimationFrame(animateSnap);} else{currentRotation = targetRotation;dialState.currentAngle = snappedAngle;} } requestAnimationFrame(animateSnap);if (dialState.enteredCombination.length <3){dialState.enteredCombination.push(snappedNumber);updateCombinationDisplay(subfaceId,device.id);if ( dialState.enteredCombination.length === dialState.targetCombination.length ){setTimeout(() =>{checkSafeDialCombination(subfaceId,device.id);},500);} } } } document.addEventListener("mousemove",handleMove);document.addEventListener("mouseup",handleEnd);document.addEventListener("touchmove",handleMove,{passive: false });document.addEventListener("touchend",handleEnd);subfaceEl.appendChild(dialContainer);subfaceEl.appendChild(combinationDisplay);} function updateDialDisplay(subfaceId,dialId){const dialState = subfaceStates[subfaceId].safeDials[dialId];const currentNumber = Math.round(dialState.currentAngle / 36) * 10;} function updateCombinationDisplay(subfaceId,dialId){const subfaceEl = document.querySelector(`[data-subface="${subfaceId}"]`);if (!subfaceEl) return;const display = subfaceEl.querySelector(".combination-display");const dialState = subfaceStates[subfaceId].safeDials[dialId];if (display && dialState){const combo = dialState.enteredCombination;const targetLength = dialState.targetCombination.length;const displayParts = [];for (let i = 0;i <targetLength;i++){displayParts.push(combo[i] !== undefined ? combo[i] : "-");} display.textContent = displayParts.join(" ");} } function checkSafeDialCombination(subfaceId,dialId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const dialState = subfaceState.safeDials[dialId];if (!dialState) return;const entered = dialState.enteredCombination;const target = dialState.targetCombination;if ( entered.length === target.length && entered.every((num,index) => num === target[index]) ){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");dialState.isLocked = false;} else if (entered.length === target.length){subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");} } function renderColorSequence(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;if (!subfaceStates[subfaceId].colorSequences){subfaceStates[subfaceId].colorSequences ={};} subfaceStates[subfaceId].colorSequences[device.id] ={targetSequence: device.sequence || ["red","blue","green","yellow"],playerSequence: [],};const container = document.createElement("div");container.className = "color-sequence-container";container.dataset.id = uniqueDeviceId;container.dataset.subface = subfaceId;container.dataset.templateDeviceId = device.id;const colors ={red:{bg: "#e74c3c",light: "#ec7063",dark: "#c0392b" },blue:{bg: "#3498db",light: "#5dade2",dark: "#2980b9" },green:{bg: "#2ecc71",light: "#58d68d",dark: "#27ae60" },yellow:{bg: "#f1c40f",light: "#f7dc6f",dark: "#d4ac0d" },};const positions = [{color: "blue",class: "top",x: 0,y: -32 },{color: "red",class: "left",x: -32,y: 0 },{color: "yellow",class: "right",x: 32,y: 0 },{color: "green",class: "bottom",x: 0,y: 32 },];positions.forEach((pos) =>{const button = document.createElement("div");button.className = `color-btn color-btn-${pos.color} color-btn-${pos.class}`;button.dataset.color = pos.color;button.style.left = `calc(50% + ${pos.x}px)`;button.style.top = `calc(50% + ${pos.y}px)`;const colorData = colors[pos.color];button.style.setProperty("--btn-color",colorData.bg);button.style.setProperty("--btn-color-light",colorData.light);button.style.setProperty("--btn-color-dark",colorData.dark);button.addEventListener("click",(e) =>{e.stopPropagation();handleColorButtonClick(device.id,pos.color,subfaceId);});button.addEventListener("touchstart",(e) =>{e.preventDefault();e.stopPropagation();button.classList.add("clicked");});button.addEventListener("touchend",(e) =>{e.preventDefault();e.stopPropagation();button.classList.remove("clicked");handleColorButtonClick(device.id,pos.color,subfaceId);});button.addEventListener("touchcancel",(e) =>{button.classList.remove("clicked");});container.appendChild(button);});subfaceEl.appendChild(container);} function showColorSequence(subfaceId,deviceId){const sequenceState = subfaceStates[subfaceId].colorSequences[deviceId];if (!sequenceState || sequenceState.isShowingSequence) return;sequenceState.isShowingSequence = true;sequenceState.playerSequence = [];const container = document.querySelector( `[data-subface="${subfaceId}"] .color-sequence-container` );if (!container) return;let currentIndex = 0;const sequence = sequenceState.targetSequence;function showNextColor(){if (currentIndex>= sequence.length){sequenceState.isShowingSequence = false;return;} const color = sequence[currentIndex];const button = container.querySelector(`.color-btn-${color}`);if (button){button.classList.add("active");setTimeout(() =>{button.classList.remove("active");currentIndex++;setTimeout(() =>{showNextColor();},200);},600);} } setTimeout(() =>{showNextColor();},500);} function handleColorButtonClick(deviceId,color,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const sequenceState = subfaceState.colorSequences[deviceId];if (!sequenceState) return;sequenceState.playerSequence.push(color);const container = document.querySelector( `[data-subface="${subfaceId}"] .color-sequence-container` );const button = container.querySelector(`.color-btn-${color}`);if (button){button.classList.add("clicked");setTimeout(() =>{button.classList.remove("clicked");},150);} if ( sequenceState.playerSequence.length === sequenceState.targetSequence.length ){const playerSeq = sequenceState.playerSequence;const targetSeq = sequenceState.targetSequence;if (playerSeq.every((color,index) => color === targetSeq[index])){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} else{subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");} } } function renderWireCutting(subfaceEl,device,subfaceId){const uniqueDeviceId = `${subfaceId}-${device.id}`;if (!subfaceStates[subfaceId].wireCutting){subfaceStates[subfaceId].wireCutting ={};} subfaceStates[subfaceId].wireCutting[device.id] ={wires: device.wires || [{colors: ["red","yellow"],correct: false,cut: false },{colors: ["blue","white"],correct: true,cut: false },{colors: ["green","black"],correct: true,cut: false },{colors: ["orange","blue"],correct: false,cut: false },{colors: ["white","red"],correct: false,cut: false },],};const container = document.createElement("div");container.className = "wire-cutting-container";container.dataset.id = uniqueDeviceId;container.dataset.subface = subfaceId;container.dataset.templateDeviceId = device.id;const wireColors ={red: "#e74c3c",blue: "#3498db",green: "#2ecc71",yellow: "#f1c40f",white: "#ecf0f1",black: "#2c3e50",orange: "#e67e22",};const wires = device.wires || subfaceStates[subfaceId].wireCutting[device.id].wires;wires.forEach((wire,index) =>{const wireElement = document.createElement("div");wireElement.className = "wire-element";const wireId = wire.colors ? wire.colors.join("-") : wire.color;wireElement.dataset.wireId = wireId;wireElement.dataset.index = index;const topConnector = document.createElement("div");topConnector.className = "wire-connector top";wireElement.appendChild(topConnector);const wireBody = document.createElement("div");wireBody.className = "wire-body";wireBody.addEventListener("click",(e) =>{e.stopPropagation();handleWireCut(device.id,wireId,subfaceId);});const continuousWire = document.createElement("div");continuousWire.className = "wire-continuous";if (wire.colors && wire.colors.length === 2){const color1 = wireColors[wire.colors[0]];const color2 = wireColors[wire.colors[1]];continuousWire.style.background = `repeating-linear-gradient( 45deg,${color1} 0px,${color1} 3px,${color2} 3px,${color2} 6px )`;continuousWire.dataset.color1 = color1;continuousWire.dataset.color2 = color2;} else{continuousWire.style.background = wireColors[wire.color || wire.colors[0]];} wireBody.appendChild(continuousWire);wireElement.appendChild(wireBody);const bottomConnector = document.createElement("div");bottomConnector.className = "wire-connector bottom";wireElement.appendChild(bottomConnector);container.appendChild(wireElement);});subfaceEl.appendChild(container);} function handleWireCut(deviceId,wireId,subfaceId){const subfaceState = subfaceStates[subfaceId];if (!subfaceState || subfaceState.status !== "pending") return;const wireCuttingState = subfaceState.wireCutting[deviceId];if (!wireCuttingState) return;const wire = wireCuttingState.wires.find((w,index) =>{const currentWireId = w.colors ? w.colors.join("-") : w.color;return currentWireId === wireId;});if (!wire || wire.cut) return;wire.cut = true;const container = document.querySelector( `[data-subface="${subfaceId}"] .wire-cutting-container` );const wireElement = container.querySelector( `.wire-element[data-wire-id="${wireId}"]` );if (wireElement){wireElement.classList.add("cut");const wireColors ={red: "#e74c3c",blue: "#3498db",green: "#2ecc71",yellow: "#f1c40f",white: "#ecf0f1",black: "#2c3e50",orange: "#e67e22",};const wireBody = wireElement.querySelector(".wire-body");if (wire.colors && wire.colors.length === 2){const color1 = wireColors[wire.colors[0]];const color2 = wireColors[wire.colors[1]];wireBody.style.setProperty( "--wire-pattern",`repeating-linear-gradient( 45deg,${color1} 0px,${color1} 3px,${color2} 3px,${color2} 6px )` );} else{wireBody.style.setProperty("--wire-color",wireColors[wire.color]);} } if (!wire.correct){subfaceState.status = "failed";setSubfaceStatus(subfaceId,"failed");return;} const correctWires = wireCuttingState.wires.filter((w) => w.correct);const cutCorrectWires = correctWires.filter((w) => w.cut);if (cutCorrectWires.length === correctWires.length){subfaceState.status = "solved";setSubfaceStatus(subfaceId,"solved");} }</script></body></html>